/*!
 * @mescius/activereports 5.2.6
 * Description: ActiveReportsJS
 * https://www.npmjs.com/package/@mescius/activereports
 * Copyright ©️ MESCIUS inc. All rights reserved.
 * Licensed under the Commercial license
 */
(function(ct,gt){typeof exports=="object"&&typeof module<"u"?gt(exports):typeof define=="function"&&define.amd?define(["exports"],gt):(ct=typeof globalThis<"u"?globalThis:ct||self,gt((ct.MESCIUS=ct.MESCIUS||{},ct.MESCIUS.ActiveReportsJS=ct.MESCIUS.ActiveReportsJS||{},ct.MESCIUS.ActiveReportsJS.TabularDataExport={})))})(this,(function(ct){"use strict";function gt(L){return L&&L.__esModule&&Object.prototype.hasOwnProperty.call(L,"default")?L.default:L}var kt={exports:{}},Wt=kt.exports,Rt;function Mt(){return Rt||(Rt=1,(function(L,j){(function(f,E){L.exports=E()})(Wt,function(){return function f(E,m,o){var s=window,r="application/octet-stream",a=o||r,_=E,y=!m&&!o&&_,g=document.createElement("a"),w=function(A){return String(A)},i=s.Blob||s.MozBlob||s.WebKitBlob||w,d=m||"download",n,h;if(i=i.call?i.bind(s):Blob,String(this)==="true"&&(_=[_,a],a=_[0],_=_[1]),y&&y.length<2048&&(d=y.split("/").pop().split("?")[0],g.href=y,g.href.indexOf(y)!==-1)){var u=new XMLHttpRequest;return u.open("GET",y,!0),u.responseType="blob",u.onload=function(A){f(A.target.response,d,r)},setTimeout(function(){u.send()},0),u}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(_))if(_.length>1024*1024*1.999&&i!==w)_=x(_),a=_.type||r;else return navigator.msSaveBlob?navigator.msSaveBlob(x(_),d):B(_);else if(/([\x80-\xff])/.test(_)){var p=0,v=new Uint8Array(_.length),S=v.length;for(p;p<S;++p)v[p]=_.charCodeAt(p);_=new i([v],{type:a})}n=_ instanceof i?_:new i([_],{type:a});function x(A){var F=A.split(/[:;,]/),R=F[1],H=F[2]=="base64"?atob:decodeURIComponent,X=H(F.pop()),b=X.length,O=0,e=new Uint8Array(b);for(O;O<b;++O)e[O]=X.charCodeAt(O);return new i([e],{type:R})}function B(A,F){if("download"in g)return g.href=A,g.setAttribute("download",d),g.className="download-js-link",g.innerHTML="downloading...",g.style.display="none",document.body.appendChild(g),setTimeout(function(){g.click(),document.body.removeChild(g),F===!0&&setTimeout(function(){s.URL.revokeObjectURL(g.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(A)&&(A="data:"+A.replace(/^data:([\w\/\-\+]+)/,r)),window.open(A)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=A),!0;var R=document.createElement("iframe");document.body.appendChild(R),!F&&/^data:/.test(A)&&(A="data:"+A.replace(/^data:([\w\/\-\+]+)/,r)),R.src=A,setTimeout(function(){document.body.removeChild(R)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(n,d);if(s.URL)B(s.URL.createObjectURL(n),!0);else{if(typeof n=="string"||n.constructor===w)try{return B("data:"+a+";base64,"+s.btoa(n))}catch{return B("data:"+a+","+encodeURIComponent(n))}h=new FileReader,h.onload=function(A){B(this.result)},h.readAsDataURL(n)}return!0}})})(kt)),kt.exports}var Ht=Mt();const Ot=gt(Ht);function Bt(L){return Array.prototype.concat(...L)}const bt=L=>L[L.length-1],xt=L=>L!=null?L.replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	"):L;function Nt(L,j="untitled"){if(typeof L=="string"){const f=new Blob(["\uFEFF"+L],{type:"text/csv"});Ot(f,j+".csv","text/csv")}else Ot(L,j+".zip","application/zip")}function Gt(){if(window&&window.arjsViewer&&typeof window.arjsViewer.registerExport=="function"){const L={formatKey:"tabular-data",friendlyName:"Tabular data",settingsDescriptors:[{name:"colSeparator",type:"string",label:"Columns Separator",category:"csv"},{name:"rowSeparator",type:"string",label:"Rows Separator",category:"csv"},{name:"quotationSymbol",type:"string",label:"Quotation Symbol",category:"csv"},{name:"tableSeparator",type:"string",label:"Tables Separator",category:"csv"},{name:"outputType",type:"enum",label:"Output Type",enumValues:{plain:"Plain text",zip:"ZIP"},category:"csv"},{name:"filename",type:"string",label:"File Name"}],defaultSettings:{filename:"ActiveReports",colSeparator:",",rowSeparator:"\\n",quotationSymbol:'"',tableSeparator:"===============",outputType:"plain"},invoke:async(j,f,E,m)=>{const{filename:o,...s}=f,r={csvSettings:{colSeparator:xt(s.colSeparator),rowSeparator:xt(s.rowSeparator),quotationSymbol:xt(s.quotationSymbol),tableSeparator:xt(s.tableSeparator),outputType:s.outputType},filename:s.filename,format:"csv"},a=await Ft(j._renderer,r,E,m);return{data:a.data,download:_=>a.download(_||o)}}};window.arjsViewer.registerExport(L)}}function St(L){throw new Error('Could not dynamically require "'+L+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var zt={exports:{}};var Dt;function Vt(){return Dt||(Dt=1,(function(L,j){(function(f){L.exports=f()})(function(){return(function f(E,m,o){function s(_,y){if(!m[_]){if(!E[_]){var g=typeof St=="function"&&St;if(!y&&g)return g(_,!0);if(r)return r(_,!0);var w=new Error("Cannot find module '"+_+"'");throw w.code="MODULE_NOT_FOUND",w}var i=m[_]={exports:{}};E[_][0].call(i.exports,function(d){var n=E[_][1][d];return s(n||d)},i,i.exports,f,E,m,o)}return m[_].exports}for(var r=typeof St=="function"&&St,a=0;a<o.length;a++)s(o[a]);return s})({1:[function(f,E,m){var o=f("./utils"),s=f("./support"),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";m.encode=function(a){for(var _,y,g,w,i,d,n,h=[],u=0,p=a.length,v=p,S=o.getTypeOf(a)!=="string";u<a.length;)v=p-u,g=S?(_=a[u++],y=u<p?a[u++]:0,u<p?a[u++]:0):(_=a.charCodeAt(u++),y=u<p?a.charCodeAt(u++):0,u<p?a.charCodeAt(u++):0),w=_>>2,i=(3&_)<<4|y>>4,d=1<v?(15&y)<<2|g>>6:64,n=2<v?63&g:64,h.push(r.charAt(w)+r.charAt(i)+r.charAt(d)+r.charAt(n));return h.join("")},m.decode=function(a){var _,y,g,w,i,d,n=0,h=0,u="data:";if(a.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var p,v=3*(a=a.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(a.charAt(a.length-1)===r.charAt(64)&&v--,a.charAt(a.length-2)===r.charAt(64)&&v--,v%1!=0)throw new Error("Invalid base64 input, bad content length.");for(p=s.uint8array?new Uint8Array(0|v):new Array(0|v);n<a.length;)_=r.indexOf(a.charAt(n++))<<2|(w=r.indexOf(a.charAt(n++)))>>4,y=(15&w)<<4|(i=r.indexOf(a.charAt(n++)))>>2,g=(3&i)<<6|(d=r.indexOf(a.charAt(n++))),p[h++]=_,i!==64&&(p[h++]=y),d!==64&&(p[h++]=g);return p}},{"./support":30,"./utils":32}],2:[function(f,E,m){var o=f("./external"),s=f("./stream/DataWorker"),r=f("./stream/Crc32Probe"),a=f("./stream/DataLengthProbe");function _(y,g,w,i,d){this.compressedSize=y,this.uncompressedSize=g,this.crc32=w,this.compression=i,this.compressedContent=d}_.prototype={getContentWorker:function(){var y=new s(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),g=this;return y.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),y},getCompressedWorker:function(){return new s(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},_.createWorkerFrom=function(y,g,w){return y.pipe(new r).pipe(new a("uncompressedSize")).pipe(g.compressWorker(w)).pipe(new a("compressedSize")).withStreamInfo("compression",g)},E.exports=_},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(f,E,m){var o=f("./stream/GenericWorker");m.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},m.DEFLATE=f("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(f,E,m){var o=f("./utils"),s=(function(){for(var r,a=[],_=0;_<256;_++){r=_;for(var y=0;y<8;y++)r=1&r?3988292384^r>>>1:r>>>1;a[_]=r}return a})();E.exports=function(r,a){return r!==void 0&&r.length?o.getTypeOf(r)!=="string"?(function(_,y,g,w){var i=s,d=w+g;_^=-1;for(var n=w;n<d;n++)_=_>>>8^i[255&(_^y[n])];return-1^_})(0|a,r,r.length,0):(function(_,y,g,w){var i=s,d=w+g;_^=-1;for(var n=w;n<d;n++)_=_>>>8^i[255&(_^y.charCodeAt(n))];return-1^_})(0|a,r,r.length,0):0}},{"./utils":32}],5:[function(f,E,m){m.base64=!1,m.binary=!1,m.dir=!1,m.createFolders=!0,m.date=null,m.compression=null,m.compressionOptions=null,m.comment=null,m.unixPermissions=null,m.dosPermissions=null},{}],6:[function(f,E,m){var o=null;o=typeof Promise<"u"?Promise:f("lie"),E.exports={Promise:o}},{lie:37}],7:[function(f,E,m){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=f("pako"),r=f("./utils"),a=f("./stream/GenericWorker"),_=o?"uint8array":"array";function y(g,w){a.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=w,this.meta={}}m.magic="\b\0",r.inherits(y,a),y.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(r.transformTo(_,g.data),!1)},y.prototype.flush=function(){a.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},y.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},y.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(w){g.push({data:w,meta:g.meta})}},m.compressWorker=function(g){return new y("Deflate",g)},m.uncompressWorker=function(){return new y("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(f,E,m){function o(i,d){var n,h="";for(n=0;n<d;n++)h+=String.fromCharCode(255&i),i>>>=8;return h}function s(i,d,n,h,u,p){var v,S,x=i.file,B=i.compression,A=p!==_.utf8encode,F=r.transformTo("string",p(x.name)),R=r.transformTo("string",_.utf8encode(x.name)),H=x.comment,X=r.transformTo("string",p(H)),b=r.transformTo("string",_.utf8encode(H)),O=R.length!==x.name.length,e=b.length!==H.length,D="",Q="",Z="",tt=x.dir,W=x.date,J={crc32:0,compressedSize:0,uncompressedSize:0};d&&!n||(J.crc32=i.crc32,J.compressedSize=i.compressedSize,J.uncompressedSize=i.uncompressedSize);var I=0;d&&(I|=8),A||!O&&!e||(I|=2048);var z=0,$=0;tt&&(z|=16),u==="UNIX"?($=798,z|=(function(V,at){var lt=V;return V||(lt=at?16893:33204),(65535&lt)<<16})(x.unixPermissions,tt)):($=20,z|=(function(V){return 63&(V||0)})(x.dosPermissions)),v=W.getUTCHours(),v<<=6,v|=W.getUTCMinutes(),v<<=5,v|=W.getUTCSeconds()/2,S=W.getUTCFullYear()-1980,S<<=4,S|=W.getUTCMonth()+1,S<<=5,S|=W.getUTCDate(),O&&(Q=o(1,1)+o(y(F),4)+R,D+="up"+o(Q.length,2)+Q),e&&(Z=o(1,1)+o(y(X),4)+b,D+="uc"+o(Z.length,2)+Z);var q="";return q+=`
\0`,q+=o(I,2),q+=B.magic,q+=o(v,2),q+=o(S,2),q+=o(J.crc32,4),q+=o(J.compressedSize,4),q+=o(J.uncompressedSize,4),q+=o(F.length,2),q+=o(D.length,2),{fileRecord:g.LOCAL_FILE_HEADER+q+F+D,dirRecord:g.CENTRAL_FILE_HEADER+o($,2)+q+o(X.length,2)+"\0\0\0\0"+o(z,4)+o(h,4)+F+D+X}}var r=f("../utils"),a=f("../stream/GenericWorker"),_=f("../utf8"),y=f("../crc32"),g=f("../signature");function w(i,d,n,h){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=d,this.zipPlatform=n,this.encodeFileName=h,this.streamFiles=i,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(w,a),w.prototype.push=function(i){var d=i.meta.percent||0,n=this.entriesCount,h=this._sources.length;this.accumulate?this.contentBuffer.push(i):(this.bytesWritten+=i.data.length,a.prototype.push.call(this,{data:i.data,meta:{currentFile:this.currentFile,percent:n?(d+100*(n-h-1))/n:100}}))},w.prototype.openedSource=function(i){this.currentSourceOffset=this.bytesWritten,this.currentFile=i.file.name;var d=this.streamFiles&&!i.file.dir;if(d){var n=s(i,d,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},w.prototype.closedSource=function(i){this.accumulate=!1;var d=this.streamFiles&&!i.file.dir,n=s(i,d,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),d)this.push({data:(function(h){return g.DATA_DESCRIPTOR+o(h.crc32,4)+o(h.compressedSize,4)+o(h.uncompressedSize,4)})(i),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},w.prototype.flush=function(){for(var i=this.bytesWritten,d=0;d<this.dirRecords.length;d++)this.push({data:this.dirRecords[d],meta:{percent:100}});var n=this.bytesWritten-i,h=(function(u,p,v,S,x){var B=r.transformTo("string",x(S));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(u,2)+o(u,2)+o(p,4)+o(v,4)+o(B.length,2)+B})(this.dirRecords.length,n,i,this.zipComment,this.encodeFileName);this.push({data:h,meta:{percent:100}})},w.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},w.prototype.registerPrevious=function(i){this._sources.push(i);var d=this;return i.on("data",function(n){d.processChunk(n)}),i.on("end",function(){d.closedSource(d.previous.streamInfo),d._sources.length?d.prepareNextSource():d.end()}),i.on("error",function(n){d.error(n)}),this},w.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},w.prototype.error=function(i){var d=this._sources;if(!a.prototype.error.call(this,i))return!1;for(var n=0;n<d.length;n++)try{d[n].error(i)}catch{}return!0},w.prototype.lock=function(){a.prototype.lock.call(this);for(var i=this._sources,d=0;d<i.length;d++)i[d].lock()},E.exports=w},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(f,E,m){var o=f("../compressions"),s=f("./ZipFileWorker");m.generateWorker=function(r,a,_){var y=new s(a.streamFiles,_,a.platform,a.encodeFileName),g=0;try{r.forEach(function(w,i){g++;var d=(function(p,v){var S=p||v,x=o[S];if(!x)throw new Error(S+" is not a valid compression method !");return x})(i.options.compression,a.compression),n=i.options.compressionOptions||a.compressionOptions||{},h=i.dir,u=i.date;i._compressWorker(d,n).withStreamInfo("file",{name:w,dir:h,date:u,comment:i.comment||"",unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions}).pipe(y)}),y.entriesCount=g}catch(w){y.error(w)}return y}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(f,E,m){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new o;for(var r in this)typeof this[r]!="function"&&(s[r]=this[r]);return s}}(o.prototype=f("./object")).loadAsync=f("./load"),o.support=f("./support"),o.defaults=f("./defaults"),o.version="3.10.1",o.loadAsync=function(s,r){return new o().loadAsync(s,r)},o.external=f("./external"),E.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(f,E,m){var o=f("./utils"),s=f("./external"),r=f("./utf8"),a=f("./zipEntries"),_=f("./stream/Crc32Probe"),y=f("./nodejsUtils");function g(w){return new s.Promise(function(i,d){var n=w.decompressed.getContentWorker().pipe(new _);n.on("error",function(h){d(h)}).on("end",function(){n.streamInfo.crc32!==w.decompressed.crc32?d(new Error("Corrupted zip : CRC32 mismatch")):i()}).resume()})}E.exports=function(w,i){var d=this;return i=o.extend(i||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:r.utf8decode}),y.isNode&&y.isStream(w)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",w,!0,i.optimizedBinaryString,i.base64).then(function(n){var h=new a(i);return h.load(n),h}).then(function(n){var h=[s.Promise.resolve(n)],u=n.files;if(i.checkCRC32)for(var p=0;p<u.length;p++)h.push(g(u[p]));return s.Promise.all(h)}).then(function(n){for(var h=n.shift(),u=h.files,p=0;p<u.length;p++){var v=u[p],S=v.fileNameStr,x=o.resolve(v.fileNameStr);d.file(x,v.decompressed,{binary:!0,optimizedBinaryString:!0,date:v.date,dir:v.dir,comment:v.fileCommentStr.length?v.fileCommentStr:null,unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions,createFolders:i.createFolders}),v.dir||(d.file(x).unsafeOriginalName=S)}return h.zipComment.length&&(d.comment=h.zipComment),d})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(f,E,m){var o=f("../utils"),s=f("../stream/GenericWorker");function r(a,_){s.call(this,"Nodejs stream input adapter for "+a),this._upstreamEnded=!1,this._bindStream(_)}o.inherits(r,s),r.prototype._bindStream=function(a){var _=this;(this._stream=a).pause(),a.on("data",function(y){_.push({data:y,meta:{percent:0}})}).on("error",function(y){_.isPaused?this.generatedError=y:_.error(y)}).on("end",function(){_.isPaused?_._upstreamEnded=!0:_.end()})},r.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},r.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},E.exports=r},{"../stream/GenericWorker":28,"../utils":32}],13:[function(f,E,m){var o=f("readable-stream").Readable;function s(r,a,_){o.call(this,a),this._helper=r;var y=this;r.on("data",function(g,w){y.push(g)||y._helper.pause(),_&&_(w)}).on("error",function(g){y.emit("error",g)}).on("end",function(){y.push(null)})}f("../utils").inherits(s,o),s.prototype._read=function(){this._helper.resume()},E.exports=s},{"../utils":32,"readable-stream":16}],14:[function(f,E,m){E.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,s);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,s)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var s=new Buffer(o);return s.fill(0),s},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(f,E,m){function o(x,B,A){var F,R=r.getTypeOf(B),H=r.extend(A||{},y);H.date=H.date||new Date,H.compression!==null&&(H.compression=H.compression.toUpperCase()),typeof H.unixPermissions=="string"&&(H.unixPermissions=parseInt(H.unixPermissions,8)),H.unixPermissions&&16384&H.unixPermissions&&(H.dir=!0),H.dosPermissions&&16&H.dosPermissions&&(H.dir=!0),H.dir&&(x=u(x)),H.createFolders&&(F=h(x))&&p.call(this,F,!0);var X=R==="string"&&H.binary===!1&&H.base64===!1;A&&A.binary!==void 0||(H.binary=!X),(B instanceof g&&B.uncompressedSize===0||H.dir||!B||B.length===0)&&(H.base64=!1,H.binary=!0,B="",H.compression="STORE",R="string");var b=null;b=B instanceof g||B instanceof a?B:d.isNode&&d.isStream(B)?new n(x,B):r.prepareContent(x,B,H.binary,H.optimizedBinaryString,H.base64);var O=new w(x,b,H);this.files[x]=O}var s=f("./utf8"),r=f("./utils"),a=f("./stream/GenericWorker"),_=f("./stream/StreamHelper"),y=f("./defaults"),g=f("./compressedObject"),w=f("./zipObject"),i=f("./generate"),d=f("./nodejsUtils"),n=f("./nodejs/NodejsStreamInputAdapter"),h=function(x){x.slice(-1)==="/"&&(x=x.substring(0,x.length-1));var B=x.lastIndexOf("/");return 0<B?x.substring(0,B):""},u=function(x){return x.slice(-1)!=="/"&&(x+="/"),x},p=function(x,B){return B=B!==void 0?B:y.createFolders,x=u(x),this.files[x]||o.call(this,x,null,{dir:!0,createFolders:B}),this.files[x]};function v(x){return Object.prototype.toString.call(x)==="[object RegExp]"}var S={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(x){var B,A,F;for(B in this.files)F=this.files[B],(A=B.slice(this.root.length,B.length))&&B.slice(0,this.root.length)===this.root&&x(A,F)},filter:function(x){var B=[];return this.forEach(function(A,F){x(A,F)&&B.push(F)}),B},file:function(x,B,A){if(arguments.length!==1)return x=this.root+x,o.call(this,x,B,A),this;if(v(x)){var F=x;return this.filter(function(H,X){return!X.dir&&F.test(H)})}var R=this.files[this.root+x];return R&&!R.dir?R:null},folder:function(x){if(!x)return this;if(v(x))return this.filter(function(R,H){return H.dir&&x.test(R)});var B=this.root+x,A=p.call(this,B),F=this.clone();return F.root=A.name,F},remove:function(x){x=this.root+x;var B=this.files[x];if(B||(x.slice(-1)!=="/"&&(x+="/"),B=this.files[x]),B&&!B.dir)delete this.files[x];else for(var A=this.filter(function(R,H){return H.name.slice(0,x.length)===x}),F=0;F<A.length;F++)delete this.files[A[F].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(x){var B,A={};try{if((A=r.extend(x||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");r.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var F=A.comment||this.comment||"";B=i.generateWorker(this,A,F)}catch(R){(B=new a("error")).error(R)}return new _(B,A.type||"string",A.mimeType)},generateAsync:function(x,B){return this.generateInternalStream(x).accumulate(B)},generateNodeStream:function(x,B){return(x=x||{}).type||(x.type="nodebuffer"),this.generateInternalStream(x).toNodejsStream(B)}};E.exports=S},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(f,E,m){E.exports=f("stream")},{stream:void 0}],17:[function(f,E,m){var o=f("./DataReader");function s(r){o.call(this,r);for(var a=0;a<this.data.length;a++)r[a]=255&r[a]}f("../utils").inherits(s,o),s.prototype.byteAt=function(r){return this.data[this.zero+r]},s.prototype.lastIndexOfSignature=function(r){for(var a=r.charCodeAt(0),_=r.charCodeAt(1),y=r.charCodeAt(2),g=r.charCodeAt(3),w=this.length-4;0<=w;--w)if(this.data[w]===a&&this.data[w+1]===_&&this.data[w+2]===y&&this.data[w+3]===g)return w-this.zero;return-1},s.prototype.readAndCheckSignature=function(r){var a=r.charCodeAt(0),_=r.charCodeAt(1),y=r.charCodeAt(2),g=r.charCodeAt(3),w=this.readData(4);return a===w[0]&&_===w[1]&&y===w[2]&&g===w[3]},s.prototype.readData=function(r){if(this.checkOffset(r),r===0)return[];var a=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,a},E.exports=s},{"../utils":32,"./DataReader":18}],18:[function(f,E,m){var o=f("../utils");function s(r){this.data=r,this.length=r.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(r){this.checkIndex(this.index+r)},checkIndex:function(r){if(this.length<this.zero+r||r<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+r+"). Corrupted zip ?")},setIndex:function(r){this.checkIndex(r),this.index=r},skip:function(r){this.setIndex(this.index+r)},byteAt:function(){},readInt:function(r){var a,_=0;for(this.checkOffset(r),a=this.index+r-1;a>=this.index;a--)_=(_<<8)+this.byteAt(a);return this.index+=r,_},readString:function(r){return o.transformTo("string",this.readData(r))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var r=this.readInt(4);return new Date(Date.UTC(1980+(r>>25&127),(r>>21&15)-1,r>>16&31,r>>11&31,r>>5&63,(31&r)<<1))}},E.exports=s},{"../utils":32}],19:[function(f,E,m){var o=f("./Uint8ArrayReader");function s(r){o.call(this,r)}f("../utils").inherits(s,o),s.prototype.readData=function(r){this.checkOffset(r);var a=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,a},E.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(f,E,m){var o=f("./DataReader");function s(r){o.call(this,r)}f("../utils").inherits(s,o),s.prototype.byteAt=function(r){return this.data.charCodeAt(this.zero+r)},s.prototype.lastIndexOfSignature=function(r){return this.data.lastIndexOf(r)-this.zero},s.prototype.readAndCheckSignature=function(r){return r===this.readData(4)},s.prototype.readData=function(r){this.checkOffset(r);var a=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,a},E.exports=s},{"../utils":32,"./DataReader":18}],21:[function(f,E,m){var o=f("./ArrayReader");function s(r){o.call(this,r)}f("../utils").inherits(s,o),s.prototype.readData=function(r){if(this.checkOffset(r),r===0)return new Uint8Array(0);var a=this.data.subarray(this.zero+this.index,this.zero+this.index+r);return this.index+=r,a},E.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(f,E,m){var o=f("../utils"),s=f("../support"),r=f("./ArrayReader"),a=f("./StringReader"),_=f("./NodeBufferReader"),y=f("./Uint8ArrayReader");E.exports=function(g){var w=o.getTypeOf(g);return o.checkSupport(w),w!=="string"||s.uint8array?w==="nodebuffer"?new _(g):s.uint8array?new y(o.transformTo("uint8array",g)):new r(o.transformTo("array",g)):new a(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(f,E,m){m.LOCAL_FILE_HEADER="PK",m.CENTRAL_FILE_HEADER="PK",m.CENTRAL_DIRECTORY_END="PK",m.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",m.ZIP64_CENTRAL_DIRECTORY_END="PK",m.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(f,E,m){var o=f("./GenericWorker"),s=f("../utils");function r(a){o.call(this,"ConvertWorker to "+a),this.destType=a}s.inherits(r,o),r.prototype.processChunk=function(a){this.push({data:s.transformTo(this.destType,a.data),meta:a.meta})},E.exports=r},{"../utils":32,"./GenericWorker":28}],25:[function(f,E,m){var o=f("./GenericWorker"),s=f("../crc32");function r(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}f("../utils").inherits(r,o),r.prototype.processChunk=function(a){this.streamInfo.crc32=s(a.data,this.streamInfo.crc32||0),this.push(a)},E.exports=r},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(f,E,m){var o=f("../utils"),s=f("./GenericWorker");function r(a){s.call(this,"DataLengthProbe for "+a),this.propName=a,this.withStreamInfo(a,0)}o.inherits(r,s),r.prototype.processChunk=function(a){if(a){var _=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=_+a.data.length}s.prototype.processChunk.call(this,a)},E.exports=r},{"../utils":32,"./GenericWorker":28}],27:[function(f,E,m){var o=f("../utils"),s=f("./GenericWorker");function r(a){s.call(this,"DataWorker");var _=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,a.then(function(y){_.dataIsReady=!0,_.data=y,_.max=y&&y.length||0,_.type=o.getTypeOf(y),_.isPaused||_._tickAndRepeat()},function(y){_.error(y)})}o.inherits(r,s),r.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},r.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},r.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},r.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var a=null,_=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":a=this.data.substring(this.index,_);break;case"uint8array":a=this.data.subarray(this.index,_);break;case"array":case"nodebuffer":a=this.data.slice(this.index,_)}return this.index=_,this.push({data:a,meta:{percent:this.max?this.index/this.max*100:0}})},E.exports=r},{"../utils":32,"./GenericWorker":28}],28:[function(f,E,m){function o(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,r){return this._listeners[s].push(r),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,r){if(this._listeners[s])for(var a=0;a<this._listeners[s].length;a++)this._listeners[s][a].call(this,r)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var r=this;return s.on("data",function(a){r.processChunk(a)}),s.on("end",function(){r.end()}),s.on("error",function(a){r.error(a)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,r){return this.extraStreamInfo[s]=r,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},E.exports=o},{}],29:[function(f,E,m){var o=f("../utils"),s=f("./ConvertWorker"),r=f("./GenericWorker"),a=f("../base64"),_=f("../support"),y=f("../external"),g=null;if(_.nodestream)try{g=f("../nodejs/NodejsStreamOutputAdapter")}catch{}function w(d,n){return new y.Promise(function(h,u){var p=[],v=d._internalType,S=d._outputType,x=d._mimeType;d.on("data",function(B,A){p.push(B),n&&n(A)}).on("error",function(B){p=[],u(B)}).on("end",function(){try{var B=(function(A,F,R){switch(A){case"blob":return o.newBlob(o.transformTo("arraybuffer",F),R);case"base64":return a.encode(F);default:return o.transformTo(A,F)}})(S,(function(A,F){var R,H=0,X=null,b=0;for(R=0;R<F.length;R++)b+=F[R].length;switch(A){case"string":return F.join("");case"array":return Array.prototype.concat.apply([],F);case"uint8array":for(X=new Uint8Array(b),R=0;R<F.length;R++)X.set(F[R],H),H+=F[R].length;return X;case"nodebuffer":return Buffer.concat(F);default:throw new Error("concat : unsupported type '"+A+"'")}})(v,p),x);h(B)}catch(A){u(A)}p=[]}).resume()})}function i(d,n,h){var u=n;switch(n){case"blob":case"arraybuffer":u="uint8array";break;case"base64":u="string"}try{this._internalType=u,this._outputType=n,this._mimeType=h,o.checkSupport(u),this._worker=d.pipe(new s(u)),d.lock()}catch(p){this._worker=new r("error"),this._worker.error(p)}}i.prototype={accumulate:function(d){return w(this,d)},on:function(d,n){var h=this;return d==="data"?this._worker.on(d,function(u){n.call(h,u.data,u.meta)}):this._worker.on(d,function(){o.delay(n,arguments,h)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(d){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},d)}},E.exports=i},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(f,E,m){if(m.base64=!0,m.array=!0,m.string=!0,m.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",m.nodebuffer=typeof Buffer<"u",m.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")m.blob=!1;else{var o=new ArrayBuffer(0);try{m.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(o),m.blob=s.getBlob("application/zip").size===0}catch{m.blob=!1}}}try{m.nodestream=!!f("readable-stream").Readable}catch{m.nodestream=!1}},{"readable-stream":16}],31:[function(f,E,m){for(var o=f("./utils"),s=f("./support"),r=f("./nodejsUtils"),a=f("./stream/GenericWorker"),_=new Array(256),y=0;y<256;y++)_[y]=252<=y?6:248<=y?5:240<=y?4:224<=y?3:192<=y?2:1;_[254]=_[254]=1;function g(){a.call(this,"utf-8 decode"),this.leftOver=null}function w(){a.call(this,"utf-8 encode")}m.utf8encode=function(i){return s.nodebuffer?r.newBufferFrom(i,"utf-8"):(function(d){var n,h,u,p,v,S=d.length,x=0;for(p=0;p<S;p++)(64512&(h=d.charCodeAt(p)))==55296&&p+1<S&&(64512&(u=d.charCodeAt(p+1)))==56320&&(h=65536+(h-55296<<10)+(u-56320),p++),x+=h<128?1:h<2048?2:h<65536?3:4;for(n=s.uint8array?new Uint8Array(x):new Array(x),p=v=0;v<x;p++)(64512&(h=d.charCodeAt(p)))==55296&&p+1<S&&(64512&(u=d.charCodeAt(p+1)))==56320&&(h=65536+(h-55296<<10)+(u-56320),p++),h<128?n[v++]=h:(h<2048?n[v++]=192|h>>>6:(h<65536?n[v++]=224|h>>>12:(n[v++]=240|h>>>18,n[v++]=128|h>>>12&63),n[v++]=128|h>>>6&63),n[v++]=128|63&h);return n})(i)},m.utf8decode=function(i){return s.nodebuffer?o.transformTo("nodebuffer",i).toString("utf-8"):(function(d){var n,h,u,p,v=d.length,S=new Array(2*v);for(n=h=0;n<v;)if((u=d[n++])<128)S[h++]=u;else if(4<(p=_[u]))S[h++]=65533,n+=p-1;else{for(u&=p===2?31:p===3?15:7;1<p&&n<v;)u=u<<6|63&d[n++],p--;1<p?S[h++]=65533:u<65536?S[h++]=u:(u-=65536,S[h++]=55296|u>>10&1023,S[h++]=56320|1023&u)}return S.length!==h&&(S.subarray?S=S.subarray(0,h):S.length=h),o.applyFromCharCode(S)})(i=o.transformTo(s.uint8array?"uint8array":"array",i))},o.inherits(g,a),g.prototype.processChunk=function(i){var d=o.transformTo(s.uint8array?"uint8array":"array",i.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var n=d;(d=new Uint8Array(n.length+this.leftOver.length)).set(this.leftOver,0),d.set(n,this.leftOver.length)}else d=this.leftOver.concat(d);this.leftOver=null}var h=(function(p,v){var S;for((v=v||p.length)>p.length&&(v=p.length),S=v-1;0<=S&&(192&p[S])==128;)S--;return S<0||S===0?v:S+_[p[S]]>v?S:v})(d),u=d;h!==d.length&&(s.uint8array?(u=d.subarray(0,h),this.leftOver=d.subarray(h,d.length)):(u=d.slice(0,h),this.leftOver=d.slice(h,d.length))),this.push({data:m.utf8decode(u),meta:i.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:m.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},m.Utf8DecodeWorker=g,o.inherits(w,a),w.prototype.processChunk=function(i){this.push({data:m.utf8encode(i.data),meta:i.meta})},m.Utf8EncodeWorker=w},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(f,E,m){var o=f("./support"),s=f("./base64"),r=f("./nodejsUtils"),a=f("./external");function _(n){return n}function y(n,h){for(var u=0;u<n.length;++u)h[u]=255&n.charCodeAt(u);return h}f("setimmediate"),m.newBlob=function(n,h){m.checkSupport("blob");try{return new Blob([n],{type:h})}catch{try{var u=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return u.append(n),u.getBlob(h)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(n,h,u){var p=[],v=0,S=n.length;if(S<=u)return String.fromCharCode.apply(null,n);for(;v<S;)h==="array"||h==="nodebuffer"?p.push(String.fromCharCode.apply(null,n.slice(v,Math.min(v+u,S)))):p.push(String.fromCharCode.apply(null,n.subarray(v,Math.min(v+u,S)))),v+=u;return p.join("")},stringifyByChar:function(n){for(var h="",u=0;u<n.length;u++)h+=String.fromCharCode(n[u]);return h},applyCanBeUsed:{uint8array:(function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,r.allocBuffer(1)).length===1}catch{return!1}})()}};function w(n){var h=65536,u=m.getTypeOf(n),p=!0;if(u==="uint8array"?p=g.applyCanBeUsed.uint8array:u==="nodebuffer"&&(p=g.applyCanBeUsed.nodebuffer),p)for(;1<h;)try{return g.stringifyByChunk(n,u,h)}catch{h=Math.floor(h/2)}return g.stringifyByChar(n)}function i(n,h){for(var u=0;u<n.length;u++)h[u]=n[u];return h}m.applyFromCharCode=w;var d={};d.string={string:_,array:function(n){return y(n,new Array(n.length))},arraybuffer:function(n){return d.string.uint8array(n).buffer},uint8array:function(n){return y(n,new Uint8Array(n.length))},nodebuffer:function(n){return y(n,r.allocBuffer(n.length))}},d.array={string:w,array:_,arraybuffer:function(n){return new Uint8Array(n).buffer},uint8array:function(n){return new Uint8Array(n)},nodebuffer:function(n){return r.newBufferFrom(n)}},d.arraybuffer={string:function(n){return w(new Uint8Array(n))},array:function(n){return i(new Uint8Array(n),new Array(n.byteLength))},arraybuffer:_,uint8array:function(n){return new Uint8Array(n)},nodebuffer:function(n){return r.newBufferFrom(new Uint8Array(n))}},d.uint8array={string:w,array:function(n){return i(n,new Array(n.length))},arraybuffer:function(n){return n.buffer},uint8array:_,nodebuffer:function(n){return r.newBufferFrom(n)}},d.nodebuffer={string:w,array:function(n){return i(n,new Array(n.length))},arraybuffer:function(n){return d.nodebuffer.uint8array(n).buffer},uint8array:function(n){return i(n,new Uint8Array(n.length))},nodebuffer:_},m.transformTo=function(n,h){if(h=h||"",!n)return h;m.checkSupport(n);var u=m.getTypeOf(h);return d[u][n](h)},m.resolve=function(n){for(var h=n.split("/"),u=[],p=0;p<h.length;p++){var v=h[p];v==="."||v===""&&p!==0&&p!==h.length-1||(v===".."?u.pop():u.push(v))}return u.join("/")},m.getTypeOf=function(n){return typeof n=="string"?"string":Object.prototype.toString.call(n)==="[object Array]"?"array":o.nodebuffer&&r.isBuffer(n)?"nodebuffer":o.uint8array&&n instanceof Uint8Array?"uint8array":o.arraybuffer&&n instanceof ArrayBuffer?"arraybuffer":void 0},m.checkSupport=function(n){if(!o[n.toLowerCase()])throw new Error(n+" is not supported by this platform")},m.MAX_VALUE_16BITS=65535,m.MAX_VALUE_32BITS=-1,m.pretty=function(n){var h,u,p="";for(u=0;u<(n||"").length;u++)p+="\\x"+((h=n.charCodeAt(u))<16?"0":"")+h.toString(16).toUpperCase();return p},m.delay=function(n,h,u){setImmediate(function(){n.apply(u||null,h||[])})},m.inherits=function(n,h){function u(){}u.prototype=h.prototype,n.prototype=new u},m.extend=function(){var n,h,u={};for(n=0;n<arguments.length;n++)for(h in arguments[n])Object.prototype.hasOwnProperty.call(arguments[n],h)&&u[h]===void 0&&(u[h]=arguments[n][h]);return u},m.prepareContent=function(n,h,u,p,v){return a.Promise.resolve(h).then(function(S){return o.blob&&(S instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(S))!==-1)&&typeof FileReader<"u"?new a.Promise(function(x,B){var A=new FileReader;A.onload=function(F){x(F.target.result)},A.onerror=function(F){B(F.target.error)},A.readAsArrayBuffer(S)}):S}).then(function(S){var x=m.getTypeOf(S);return x?(x==="arraybuffer"?S=m.transformTo("uint8array",S):x==="string"&&(v?S=s.decode(S):u&&p!==!0&&(S=(function(B){return y(B,o.uint8array?new Uint8Array(B.length):new Array(B.length))})(S))),S):a.Promise.reject(new Error("Can't read the data of '"+n+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(f,E,m){var o=f("./reader/readerFor"),s=f("./utils"),r=f("./signature"),a=f("./zipEntry"),_=f("./support");function y(g){this.files=[],this.loadOptions=g}y.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var w=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(w)+", expected "+s.pretty(g)+")")}},isSignature:function(g,w){var i=this.reader.index;this.reader.setIndex(g);var d=this.reader.readString(4)===w;return this.reader.setIndex(i),d},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),w=_.uint8array?"uint8array":"array",i=s.transformTo(w,g);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,w,i,d=this.zip64EndOfCentralSize-44;0<d;)g=this.reader.readInt(2),w=this.reader.readInt(4),i=this.reader.readData(w),this.zip64ExtensibleData[g]={id:g,length:w,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,w;for(g=0;g<this.files.length;g++)w=this.files[g],this.reader.setIndex(w.localHeaderOffset),this.checkSignature(r.LOCAL_FILE_HEADER),w.readLocalPart(this.reader),w.handleUTF8(),w.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(r.CENTRAL_FILE_HEADER);)(g=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(r.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,r.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var w=g;if(this.checkSignature(r.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,r.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var i=this.centralDirOffset+this.centralDirSize;this.zip64&&(i+=20,i+=12+this.zip64EndOfCentralSize);var d=w-i;if(0<d)this.isSignature(w,r.CENTRAL_FILE_HEADER)||(this.reader.zero=d);else if(d<0)throw new Error("Corrupted zip: missing "+Math.abs(d)+" bytes.")},prepareReader:function(g){this.reader=o(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},E.exports=y},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(f,E,m){var o=f("./reader/readerFor"),s=f("./utils"),r=f("./compressedObject"),a=f("./crc32"),_=f("./utf8"),y=f("./compressions"),g=f("./support");function w(i,d){this.options=i,this.loadOptions=d}w.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(i){var d,n;if(i.skip(22),this.fileNameLength=i.readInt(2),n=i.readInt(2),this.fileName=i.readData(this.fileNameLength),i.skip(n),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((d=(function(h){for(var u in y)if(Object.prototype.hasOwnProperty.call(y,u)&&y[u].magic===h)return y[u];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new r(this.compressedSize,this.uncompressedSize,this.crc32,d,i.readData(this.compressedSize))},readCentralPart:function(i){this.versionMadeBy=i.readInt(2),i.skip(2),this.bitFlag=i.readInt(2),this.compressionMethod=i.readString(2),this.date=i.readDate(),this.crc32=i.readInt(4),this.compressedSize=i.readInt(4),this.uncompressedSize=i.readInt(4);var d=i.readInt(2);if(this.extraFieldsLength=i.readInt(2),this.fileCommentLength=i.readInt(2),this.diskNumberStart=i.readInt(2),this.internalFileAttributes=i.readInt(2),this.externalFileAttributes=i.readInt(4),this.localHeaderOffset=i.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");i.skip(d),this.readExtraFields(i),this.parseZIP64ExtraField(i),this.fileComment=i.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var i=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),i==0&&(this.dosPermissions=63&this.externalFileAttributes),i==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var i=o(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=i.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=i.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=i.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=i.readInt(4))}},readExtraFields:function(i){var d,n,h,u=i.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});i.index+4<u;)d=i.readInt(2),n=i.readInt(2),h=i.readData(n),this.extraFields[d]={id:d,length:n,value:h};i.setIndex(u)},handleUTF8:function(){var i=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=_.utf8decode(this.fileName),this.fileCommentStr=_.utf8decode(this.fileComment);else{var d=this.findExtraFieldUnicodePath();if(d!==null)this.fileNameStr=d;else{var n=s.transformTo(i,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var h=this.findExtraFieldUnicodeComment();if(h!==null)this.fileCommentStr=h;else{var u=s.transformTo(i,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(u)}}},findExtraFieldUnicodePath:function(){var i=this.extraFields[28789];if(i){var d=o(i.value);return d.readInt(1)!==1||a(this.fileName)!==d.readInt(4)?null:_.utf8decode(d.readData(i.length-5))}return null},findExtraFieldUnicodeComment:function(){var i=this.extraFields[25461];if(i){var d=o(i.value);return d.readInt(1)!==1||a(this.fileComment)!==d.readInt(4)?null:_.utf8decode(d.readData(i.length-5))}return null}},E.exports=w},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(f,E,m){function o(d,n,h){this.name=d,this.dir=h.dir,this.date=h.date,this.comment=h.comment,this.unixPermissions=h.unixPermissions,this.dosPermissions=h.dosPermissions,this._data=n,this._dataBinary=h.binary,this.options={compression:h.compression,compressionOptions:h.compressionOptions}}var s=f("./stream/StreamHelper"),r=f("./stream/DataWorker"),a=f("./utf8"),_=f("./compressedObject"),y=f("./stream/GenericWorker");o.prototype={internalStream:function(d){var n=null,h="string";try{if(!d)throw new Error("No output type specified.");var u=(h=d.toLowerCase())==="string"||h==="text";h!=="binarystring"&&h!=="text"||(h="string"),n=this._decompressWorker();var p=!this._dataBinary;p&&!u&&(n=n.pipe(new a.Utf8EncodeWorker)),!p&&u&&(n=n.pipe(new a.Utf8DecodeWorker))}catch(v){(n=new y("error")).error(v)}return new s(n,h,"")},async:function(d,n){return this.internalStream(d).accumulate(n)},nodeStream:function(d,n){return this.internalStream(d||"nodebuffer").toNodejsStream(n)},_compressWorker:function(d,n){if(this._data instanceof _&&this._data.compression.magic===d.magic)return this._data.getCompressedWorker();var h=this._decompressWorker();return this._dataBinary||(h=h.pipe(new a.Utf8EncodeWorker)),_.createWorkerFrom(h,d,n)},_decompressWorker:function(){return this._data instanceof _?this._data.getContentWorker():this._data instanceof y?this._data:new r(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],w=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},i=0;i<g.length;i++)o.prototype[g[i]]=w;E.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(f,E,m){(function(o){var s,r,a=o.MutationObserver||o.WebKitMutationObserver;if(a){var _=0,y=new a(d),g=o.document.createTextNode("");y.observe(g,{characterData:!0}),s=function(){g.data=_=++_%2}}else if(o.setImmediate||o.MessageChannel===void 0)s="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var n=o.document.createElement("script");n.onreadystatechange=function(){d(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},o.document.documentElement.appendChild(n)}:function(){setTimeout(d,0)};else{var w=new o.MessageChannel;w.port1.onmessage=d,s=function(){w.port2.postMessage(0)}}var i=[];function d(){var n,h;r=!0;for(var u=i.length;u;){for(h=i,i=[],n=-1;++n<u;)h[n]();u=i.length}r=!1}E.exports=function(n){i.push(n)!==1||r||s()}}).call(this,typeof window<"u"?window:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(f,E,m){var o=f("immediate");function s(){}var r={},a=["REJECTED"],_=["FULFILLED"],y=["PENDING"];function g(u){if(typeof u!="function")throw new TypeError("resolver must be a function");this.state=y,this.queue=[],this.outcome=void 0,u!==s&&n(this,u)}function w(u,p,v){this.promise=u,typeof p=="function"&&(this.onFulfilled=p,this.callFulfilled=this.otherCallFulfilled),typeof v=="function"&&(this.onRejected=v,this.callRejected=this.otherCallRejected)}function i(u,p,v){o(function(){var S;try{S=p(v)}catch(x){return r.reject(u,x)}S===u?r.reject(u,new TypeError("Cannot resolve promise with itself")):r.resolve(u,S)})}function d(u){var p=u&&u.then;if(u&&(typeof u=="object"||typeof u=="function")&&typeof p=="function")return function(){p.apply(u,arguments)}}function n(u,p){var v=!1;function S(A){v||(v=!0,r.reject(u,A))}function x(A){v||(v=!0,r.resolve(u,A))}var B=h(function(){p(x,S)});B.status==="error"&&S(B.value)}function h(u,p){var v={};try{v.value=u(p),v.status="success"}catch(S){v.status="error",v.value=S}return v}(E.exports=g).prototype.finally=function(u){if(typeof u!="function")return this;var p=this.constructor;return this.then(function(v){return p.resolve(u()).then(function(){return v})},function(v){return p.resolve(u()).then(function(){throw v})})},g.prototype.catch=function(u){return this.then(null,u)},g.prototype.then=function(u,p){if(typeof u!="function"&&this.state===_||typeof p!="function"&&this.state===a)return this;var v=new this.constructor(s);return this.state!==y?i(v,this.state===_?u:p,this.outcome):this.queue.push(new w(v,u,p)),v},w.prototype.callFulfilled=function(u){r.resolve(this.promise,u)},w.prototype.otherCallFulfilled=function(u){i(this.promise,this.onFulfilled,u)},w.prototype.callRejected=function(u){r.reject(this.promise,u)},w.prototype.otherCallRejected=function(u){i(this.promise,this.onRejected,u)},r.resolve=function(u,p){var v=h(d,p);if(v.status==="error")return r.reject(u,v.value);var S=v.value;if(S)n(u,S);else{u.state=_,u.outcome=p;for(var x=-1,B=u.queue.length;++x<B;)u.queue[x].callFulfilled(p)}return u},r.reject=function(u,p){u.state=a,u.outcome=p;for(var v=-1,S=u.queue.length;++v<S;)u.queue[v].callRejected(p);return u},g.resolve=function(u){return u instanceof this?u:r.resolve(new this(s),u)},g.reject=function(u){var p=new this(s);return r.reject(p,u)},g.all=function(u){var p=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=u.length,S=!1;if(!v)return this.resolve([]);for(var x=new Array(v),B=0,A=-1,F=new this(s);++A<v;)R(u[A],A);return F;function R(H,X){p.resolve(H).then(function(b){x[X]=b,++B!==v||S||(S=!0,r.resolve(F,x))},function(b){S||(S=!0,r.reject(F,b))})}},g.race=function(u){var p=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=u.length,S=!1;if(!v)return this.resolve([]);for(var x=-1,B=new this(s);++x<v;)A=u[x],p.resolve(A).then(function(F){S||(S=!0,r.resolve(B,F))},function(F){S||(S=!0,r.reject(B,F))});var A;return B}},{immediate:36}],38:[function(f,E,m){var o={};(0,f("./lib/utils/common").assign)(o,f("./lib/deflate"),f("./lib/inflate"),f("./lib/zlib/constants")),E.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(f,E,m){var o=f("./zlib/deflate"),s=f("./utils/common"),r=f("./utils/strings"),a=f("./zlib/messages"),_=f("./zlib/zstream"),y=Object.prototype.toString,g=0,w=-1,i=0,d=8;function n(u){if(!(this instanceof n))return new n(u);this.options=s.assign({level:w,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:i,to:""},u||{});var p=this.options;p.raw&&0<p.windowBits?p.windowBits=-p.windowBits:p.gzip&&0<p.windowBits&&p.windowBits<16&&(p.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var v=o.deflateInit2(this.strm,p.level,p.method,p.windowBits,p.memLevel,p.strategy);if(v!==g)throw new Error(a[v]);if(p.header&&o.deflateSetHeader(this.strm,p.header),p.dictionary){var S;if(S=typeof p.dictionary=="string"?r.string2buf(p.dictionary):y.call(p.dictionary)==="[object ArrayBuffer]"?new Uint8Array(p.dictionary):p.dictionary,(v=o.deflateSetDictionary(this.strm,S))!==g)throw new Error(a[v]);this._dict_set=!0}}function h(u,p){var v=new n(p);if(v.push(u,!0),v.err)throw v.msg||a[v.err];return v.result}n.prototype.push=function(u,p){var v,S,x=this.strm,B=this.options.chunkSize;if(this.ended)return!1;S=p===~~p?p:p===!0?4:0,typeof u=="string"?x.input=r.string2buf(u):y.call(u)==="[object ArrayBuffer]"?x.input=new Uint8Array(u):x.input=u,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new s.Buf8(B),x.next_out=0,x.avail_out=B),(v=o.deflate(x,S))!==1&&v!==g)return this.onEnd(v),!(this.ended=!0);x.avail_out!==0&&(x.avail_in!==0||S!==4&&S!==2)||(this.options.to==="string"?this.onData(r.buf2binstring(s.shrinkBuf(x.output,x.next_out))):this.onData(s.shrinkBuf(x.output,x.next_out)))}while((0<x.avail_in||x.avail_out===0)&&v!==1);return S===4?(v=o.deflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===g):S!==2||(this.onEnd(g),!(x.avail_out=0))},n.prototype.onData=function(u){this.chunks.push(u)},n.prototype.onEnd=function(u){u===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=u,this.msg=this.strm.msg},m.Deflate=n,m.deflate=h,m.deflateRaw=function(u,p){return(p=p||{}).raw=!0,h(u,p)},m.gzip=function(u,p){return(p=p||{}).gzip=!0,h(u,p)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(f,E,m){var o=f("./zlib/inflate"),s=f("./utils/common"),r=f("./utils/strings"),a=f("./zlib/constants"),_=f("./zlib/messages"),y=f("./zlib/zstream"),g=f("./zlib/gzheader"),w=Object.prototype.toString;function i(n){if(!(this instanceof i))return new i(n);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},n||{});var h=this.options;h.raw&&0<=h.windowBits&&h.windowBits<16&&(h.windowBits=-h.windowBits,h.windowBits===0&&(h.windowBits=-15)),!(0<=h.windowBits&&h.windowBits<16)||n&&n.windowBits||(h.windowBits+=32),15<h.windowBits&&h.windowBits<48&&(15&h.windowBits)==0&&(h.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var u=o.inflateInit2(this.strm,h.windowBits);if(u!==a.Z_OK)throw new Error(_[u]);this.header=new g,o.inflateGetHeader(this.strm,this.header)}function d(n,h){var u=new i(h);if(u.push(n,!0),u.err)throw u.msg||_[u.err];return u.result}i.prototype.push=function(n,h){var u,p,v,S,x,B,A=this.strm,F=this.options.chunkSize,R=this.options.dictionary,H=!1;if(this.ended)return!1;p=h===~~h?h:h===!0?a.Z_FINISH:a.Z_NO_FLUSH,typeof n=="string"?A.input=r.binstring2buf(n):w.call(n)==="[object ArrayBuffer]"?A.input=new Uint8Array(n):A.input=n,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new s.Buf8(F),A.next_out=0,A.avail_out=F),(u=o.inflate(A,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&R&&(B=typeof R=="string"?r.string2buf(R):w.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,u=o.inflateSetDictionary(this.strm,B)),u===a.Z_BUF_ERROR&&H===!0&&(u=a.Z_OK,H=!1),u!==a.Z_STREAM_END&&u!==a.Z_OK)return this.onEnd(u),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&u!==a.Z_STREAM_END&&(A.avail_in!==0||p!==a.Z_FINISH&&p!==a.Z_SYNC_FLUSH)||(this.options.to==="string"?(v=r.utf8border(A.output,A.next_out),S=A.next_out-v,x=r.buf2string(A.output,v),A.next_out=S,A.avail_out=F-S,S&&s.arraySet(A.output,A.output,v,S,0),this.onData(x)):this.onData(s.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(H=!0)}while((0<A.avail_in||A.avail_out===0)&&u!==a.Z_STREAM_END);return u===a.Z_STREAM_END&&(p=a.Z_FINISH),p===a.Z_FINISH?(u=o.inflateEnd(this.strm),this.onEnd(u),this.ended=!0,u===a.Z_OK):p!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!(A.avail_out=0))},i.prototype.onData=function(n){this.chunks.push(n)},i.prototype.onEnd=function(n){n===a.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg},m.Inflate=i,m.inflate=d,m.inflateRaw=function(n,h){return(h=h||{}).raw=!0,d(n,h)},m.ungzip=d},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(f,E,m){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";m.assign=function(a){for(var _=Array.prototype.slice.call(arguments,1);_.length;){var y=_.shift();if(y){if(typeof y!="object")throw new TypeError(y+"must be non-object");for(var g in y)y.hasOwnProperty(g)&&(a[g]=y[g])}}return a},m.shrinkBuf=function(a,_){return a.length===_?a:a.subarray?a.subarray(0,_):(a.length=_,a)};var s={arraySet:function(a,_,y,g,w){if(_.subarray&&a.subarray)a.set(_.subarray(y,y+g),w);else for(var i=0;i<g;i++)a[w+i]=_[y+i]},flattenChunks:function(a){var _,y,g,w,i,d;for(_=g=0,y=a.length;_<y;_++)g+=a[_].length;for(d=new Uint8Array(g),_=w=0,y=a.length;_<y;_++)i=a[_],d.set(i,w),w+=i.length;return d}},r={arraySet:function(a,_,y,g,w){for(var i=0;i<g;i++)a[w+i]=_[y+i]},flattenChunks:function(a){return[].concat.apply([],a)}};m.setTyped=function(a){a?(m.Buf8=Uint8Array,m.Buf16=Uint16Array,m.Buf32=Int32Array,m.assign(m,s)):(m.Buf8=Array,m.Buf16=Array,m.Buf32=Array,m.assign(m,r))},m.setTyped(o)},{}],42:[function(f,E,m){var o=f("./common"),s=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{r=!1}for(var a=new o.Buf8(256),_=0;_<256;_++)a[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;function y(g,w){if(w<65537&&(g.subarray&&r||!g.subarray&&s))return String.fromCharCode.apply(null,o.shrinkBuf(g,w));for(var i="",d=0;d<w;d++)i+=String.fromCharCode(g[d]);return i}a[254]=a[254]=1,m.string2buf=function(g){var w,i,d,n,h,u=g.length,p=0;for(n=0;n<u;n++)(64512&(i=g.charCodeAt(n)))==55296&&n+1<u&&(64512&(d=g.charCodeAt(n+1)))==56320&&(i=65536+(i-55296<<10)+(d-56320),n++),p+=i<128?1:i<2048?2:i<65536?3:4;for(w=new o.Buf8(p),n=h=0;h<p;n++)(64512&(i=g.charCodeAt(n)))==55296&&n+1<u&&(64512&(d=g.charCodeAt(n+1)))==56320&&(i=65536+(i-55296<<10)+(d-56320),n++),i<128?w[h++]=i:(i<2048?w[h++]=192|i>>>6:(i<65536?w[h++]=224|i>>>12:(w[h++]=240|i>>>18,w[h++]=128|i>>>12&63),w[h++]=128|i>>>6&63),w[h++]=128|63&i);return w},m.buf2binstring=function(g){return y(g,g.length)},m.binstring2buf=function(g){for(var w=new o.Buf8(g.length),i=0,d=w.length;i<d;i++)w[i]=g.charCodeAt(i);return w},m.buf2string=function(g,w){var i,d,n,h,u=w||g.length,p=new Array(2*u);for(i=d=0;i<u;)if((n=g[i++])<128)p[d++]=n;else if(4<(h=a[n]))p[d++]=65533,i+=h-1;else{for(n&=h===2?31:h===3?15:7;1<h&&i<u;)n=n<<6|63&g[i++],h--;1<h?p[d++]=65533:n<65536?p[d++]=n:(n-=65536,p[d++]=55296|n>>10&1023,p[d++]=56320|1023&n)}return y(p,d)},m.utf8border=function(g,w){var i;for((w=w||g.length)>g.length&&(w=g.length),i=w-1;0<=i&&(192&g[i])==128;)i--;return i<0||i===0?w:i+a[g[i]]>w?i:w}},{"./common":41}],43:[function(f,E,m){E.exports=function(o,s,r,a){for(var _=65535&o|0,y=o>>>16&65535|0,g=0;r!==0;){for(r-=g=2e3<r?2e3:r;y=y+(_=_+s[a++]|0)|0,--g;);_%=65521,y%=65521}return _|y<<16|0}},{}],44:[function(f,E,m){E.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(f,E,m){var o=(function(){for(var s,r=[],a=0;a<256;a++){s=a;for(var _=0;_<8;_++)s=1&s?3988292384^s>>>1:s>>>1;r[a]=s}return r})();E.exports=function(s,r,a,_){var y=o,g=_+a;s^=-1;for(var w=_;w<g;w++)s=s>>>8^y[255&(s^r[w])];return-1^s}},{}],46:[function(f,E,m){var o,s=f("../utils/common"),r=f("./trees"),a=f("./adler32"),_=f("./crc32"),y=f("./messages"),g=0,w=4,i=0,d=-2,n=-1,h=4,u=2,p=8,v=9,S=286,x=30,B=19,A=2*S+1,F=15,R=3,H=258,X=H+R+1,b=42,O=113,e=1,D=2,Q=3,Z=4;function tt(t,N){return t.msg=y[N],N}function W(t){return(t<<1)-(4<t?9:0)}function J(t){for(var N=t.length;0<=--N;)t[N]=0}function I(t){var N=t.state,T=N.pending;T>t.avail_out&&(T=t.avail_out),T!==0&&(s.arraySet(t.output,N.pending_buf,N.pending_out,T,t.next_out),t.next_out+=T,N.pending_out+=T,t.total_out+=T,t.avail_out-=T,N.pending-=T,N.pending===0&&(N.pending_out=0))}function z(t,N){r._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,N),t.block_start=t.strstart,I(t.strm)}function $(t,N){t.pending_buf[t.pending++]=N}function q(t,N){t.pending_buf[t.pending++]=N>>>8&255,t.pending_buf[t.pending++]=255&N}function V(t,N){var T,c,l=t.max_chain_length,k=t.strstart,U=t.prev_length,P=t.nice_match,C=t.strstart>t.w_size-X?t.strstart-(t.w_size-X):0,M=t.window,K=t.w_mask,G=t.prev,Y=t.strstart+H,it=M[k+U-1],rt=M[k+U];t.prev_length>=t.good_match&&(l>>=2),P>t.lookahead&&(P=t.lookahead);do if(M[(T=N)+U]===rt&&M[T+U-1]===it&&M[T]===M[k]&&M[++T]===M[k+1]){k+=2,T++;do;while(M[++k]===M[++T]&&M[++k]===M[++T]&&M[++k]===M[++T]&&M[++k]===M[++T]&&M[++k]===M[++T]&&M[++k]===M[++T]&&M[++k]===M[++T]&&M[++k]===M[++T]&&k<Y);if(c=H-(Y-k),k=Y-H,U<c){if(t.match_start=N,P<=(U=c))break;it=M[k+U-1],rt=M[k+U]}}while((N=G[N&K])>C&&--l!=0);return U<=t.lookahead?U:t.lookahead}function at(t){var N,T,c,l,k,U,P,C,M,K,G=t.w_size;do{if(l=t.window_size-t.lookahead-t.strstart,t.strstart>=G+(G-X)){for(s.arraySet(t.window,t.window,G,G,0),t.match_start-=G,t.strstart-=G,t.block_start-=G,N=T=t.hash_size;c=t.head[--N],t.head[N]=G<=c?c-G:0,--T;);for(N=T=G;c=t.prev[--N],t.prev[N]=G<=c?c-G:0,--T;);l+=G}if(t.strm.avail_in===0)break;if(U=t.strm,P=t.window,C=t.strstart+t.lookahead,M=l,K=void 0,K=U.avail_in,M<K&&(K=M),T=K===0?0:(U.avail_in-=K,s.arraySet(P,U.input,U.next_in,K,C),U.state.wrap===1?U.adler=a(U.adler,P,K,C):U.state.wrap===2&&(U.adler=_(U.adler,P,K,C)),U.next_in+=K,U.total_in+=K,K),t.lookahead+=T,t.lookahead+t.insert>=R)for(k=t.strstart-t.insert,t.ins_h=t.window[k],t.ins_h=(t.ins_h<<t.hash_shift^t.window[k+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[k+R-1])&t.hash_mask,t.prev[k&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=k,k++,t.insert--,!(t.lookahead+t.insert<R)););}while(t.lookahead<X&&t.strm.avail_in!==0)}function lt(t,N){for(var T,c;;){if(t.lookahead<X){if(at(t),t.lookahead<X&&N===g)return e;if(t.lookahead===0)break}if(T=0,t.lookahead>=R&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,T=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),T!==0&&t.strstart-T<=t.w_size-X&&(t.match_length=V(t,T)),t.match_length>=R)if(c=r._tr_tally(t,t.strstart-t.match_start,t.match_length-R),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=R){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,T=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,--t.match_length!=0;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else c=r._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(c&&(z(t,!1),t.strm.avail_out===0))return e}return t.insert=t.strstart<R-1?t.strstart:R-1,N===w?(z(t,!0),t.strm.avail_out===0?Q:Z):t.last_lit&&(z(t,!1),t.strm.avail_out===0)?e:D}function et(t,N){for(var T,c,l;;){if(t.lookahead<X){if(at(t),t.lookahead<X&&N===g)return e;if(t.lookahead===0)break}if(T=0,t.lookahead>=R&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,T=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=R-1,T!==0&&t.prev_length<t.max_lazy_match&&t.strstart-T<=t.w_size-X&&(t.match_length=V(t,T),t.match_length<=5&&(t.strategy===1||t.match_length===R&&4096<t.strstart-t.match_start)&&(t.match_length=R-1)),t.prev_length>=R&&t.match_length<=t.prev_length){for(l=t.strstart+t.lookahead-R,c=r._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-R),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=l&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,T=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),--t.prev_length!=0;);if(t.match_available=0,t.match_length=R-1,t.strstart++,c&&(z(t,!1),t.strm.avail_out===0))return e}else if(t.match_available){if((c=r._tr_tally(t,0,t.window[t.strstart-1]))&&z(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return e}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(c=r._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<R-1?t.strstart:R-1,N===w?(z(t,!0),t.strm.avail_out===0?Q:Z):t.last_lit&&(z(t,!1),t.strm.avail_out===0)?e:D}function nt(t,N,T,c,l){this.good_length=t,this.max_lazy=N,this.nice_length=T,this.max_chain=c,this.func=l}function ut(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=p,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*A),this.dyn_dtree=new s.Buf16(2*(2*x+1)),this.bl_tree=new s.Buf16(2*(2*B+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(F+1),this.heap=new s.Buf16(2*S+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*S+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function st(t){var N;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=u,(N=t.state).pending=0,N.pending_out=0,N.wrap<0&&(N.wrap=-N.wrap),N.status=N.wrap?b:O,t.adler=N.wrap===2?0:1,N.last_flush=g,r._tr_init(N),i):tt(t,d)}function dt(t){var N=st(t);return N===i&&(function(T){T.window_size=2*T.w_size,J(T.head),T.max_lazy_match=o[T.level].max_lazy,T.good_match=o[T.level].good_length,T.nice_match=o[T.level].nice_length,T.max_chain_length=o[T.level].max_chain,T.strstart=0,T.block_start=0,T.lookahead=0,T.insert=0,T.match_length=T.prev_length=R-1,T.match_available=0,T.ins_h=0})(t.state),N}function ft(t,N,T,c,l,k){if(!t)return d;var U=1;if(N===n&&(N=6),c<0?(U=0,c=-c):15<c&&(U=2,c-=16),l<1||v<l||T!==p||c<8||15<c||N<0||9<N||k<0||h<k)return tt(t,d);c===8&&(c=9);var P=new ut;return(t.state=P).strm=t,P.wrap=U,P.gzhead=null,P.w_bits=c,P.w_size=1<<P.w_bits,P.w_mask=P.w_size-1,P.hash_bits=l+7,P.hash_size=1<<P.hash_bits,P.hash_mask=P.hash_size-1,P.hash_shift=~~((P.hash_bits+R-1)/R),P.window=new s.Buf8(2*P.w_size),P.head=new s.Buf16(P.hash_size),P.prev=new s.Buf16(P.w_size),P.lit_bufsize=1<<l+6,P.pending_buf_size=4*P.lit_bufsize,P.pending_buf=new s.Buf8(P.pending_buf_size),P.d_buf=1*P.lit_bufsize,P.l_buf=3*P.lit_bufsize,P.level=N,P.strategy=k,P.method=T,dt(t)}o=[new nt(0,0,0,0,function(t,N){var T=65535;for(T>t.pending_buf_size-5&&(T=t.pending_buf_size-5);;){if(t.lookahead<=1){if(at(t),t.lookahead===0&&N===g)return e;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var c=t.block_start+T;if((t.strstart===0||t.strstart>=c)&&(t.lookahead=t.strstart-c,t.strstart=c,z(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-X&&(z(t,!1),t.strm.avail_out===0))return e}return t.insert=0,N===w?(z(t,!0),t.strm.avail_out===0?Q:Z):(t.strstart>t.block_start&&(z(t,!1),t.strm.avail_out),e)}),new nt(4,4,8,4,lt),new nt(4,5,16,8,lt),new nt(4,6,32,32,lt),new nt(4,4,16,16,et),new nt(8,16,32,32,et),new nt(8,16,128,128,et),new nt(8,32,128,256,et),new nt(32,128,258,1024,et),new nt(32,258,258,4096,et)],m.deflateInit=function(t,N){return ft(t,N,p,15,8,0)},m.deflateInit2=ft,m.deflateReset=dt,m.deflateResetKeep=st,m.deflateSetHeader=function(t,N){return t&&t.state?t.state.wrap!==2?d:(t.state.gzhead=N,i):d},m.deflate=function(t,N){var T,c,l,k;if(!t||!t.state||5<N||N<0)return t?tt(t,d):d;if(c=t.state,!t.output||!t.input&&t.avail_in!==0||c.status===666&&N!==w)return tt(t,t.avail_out===0?-5:d);if(c.strm=t,T=c.last_flush,c.last_flush=N,c.status===b)if(c.wrap===2)t.adler=0,$(c,31),$(c,139),$(c,8),c.gzhead?($(c,(c.gzhead.text?1:0)+(c.gzhead.hcrc?2:0)+(c.gzhead.extra?4:0)+(c.gzhead.name?8:0)+(c.gzhead.comment?16:0)),$(c,255&c.gzhead.time),$(c,c.gzhead.time>>8&255),$(c,c.gzhead.time>>16&255),$(c,c.gzhead.time>>24&255),$(c,c.level===9?2:2<=c.strategy||c.level<2?4:0),$(c,255&c.gzhead.os),c.gzhead.extra&&c.gzhead.extra.length&&($(c,255&c.gzhead.extra.length),$(c,c.gzhead.extra.length>>8&255)),c.gzhead.hcrc&&(t.adler=_(t.adler,c.pending_buf,c.pending,0)),c.gzindex=0,c.status=69):($(c,0),$(c,0),$(c,0),$(c,0),$(c,0),$(c,c.level===9?2:2<=c.strategy||c.level<2?4:0),$(c,3),c.status=O);else{var U=p+(c.w_bits-8<<4)<<8;U|=(2<=c.strategy||c.level<2?0:c.level<6?1:c.level===6?2:3)<<6,c.strstart!==0&&(U|=32),U+=31-U%31,c.status=O,q(c,U),c.strstart!==0&&(q(c,t.adler>>>16),q(c,65535&t.adler)),t.adler=1}if(c.status===69)if(c.gzhead.extra){for(l=c.pending;c.gzindex<(65535&c.gzhead.extra.length)&&(c.pending!==c.pending_buf_size||(c.gzhead.hcrc&&c.pending>l&&(t.adler=_(t.adler,c.pending_buf,c.pending-l,l)),I(t),l=c.pending,c.pending!==c.pending_buf_size));)$(c,255&c.gzhead.extra[c.gzindex]),c.gzindex++;c.gzhead.hcrc&&c.pending>l&&(t.adler=_(t.adler,c.pending_buf,c.pending-l,l)),c.gzindex===c.gzhead.extra.length&&(c.gzindex=0,c.status=73)}else c.status=73;if(c.status===73)if(c.gzhead.name){l=c.pending;do{if(c.pending===c.pending_buf_size&&(c.gzhead.hcrc&&c.pending>l&&(t.adler=_(t.adler,c.pending_buf,c.pending-l,l)),I(t),l=c.pending,c.pending===c.pending_buf_size)){k=1;break}k=c.gzindex<c.gzhead.name.length?255&c.gzhead.name.charCodeAt(c.gzindex++):0,$(c,k)}while(k!==0);c.gzhead.hcrc&&c.pending>l&&(t.adler=_(t.adler,c.pending_buf,c.pending-l,l)),k===0&&(c.gzindex=0,c.status=91)}else c.status=91;if(c.status===91)if(c.gzhead.comment){l=c.pending;do{if(c.pending===c.pending_buf_size&&(c.gzhead.hcrc&&c.pending>l&&(t.adler=_(t.adler,c.pending_buf,c.pending-l,l)),I(t),l=c.pending,c.pending===c.pending_buf_size)){k=1;break}k=c.gzindex<c.gzhead.comment.length?255&c.gzhead.comment.charCodeAt(c.gzindex++):0,$(c,k)}while(k!==0);c.gzhead.hcrc&&c.pending>l&&(t.adler=_(t.adler,c.pending_buf,c.pending-l,l)),k===0&&(c.status=103)}else c.status=103;if(c.status===103&&(c.gzhead.hcrc?(c.pending+2>c.pending_buf_size&&I(t),c.pending+2<=c.pending_buf_size&&($(c,255&t.adler),$(c,t.adler>>8&255),t.adler=0,c.status=O)):c.status=O),c.pending!==0){if(I(t),t.avail_out===0)return c.last_flush=-1,i}else if(t.avail_in===0&&W(N)<=W(T)&&N!==w)return tt(t,-5);if(c.status===666&&t.avail_in!==0)return tt(t,-5);if(t.avail_in!==0||c.lookahead!==0||N!==g&&c.status!==666){var P=c.strategy===2?(function(C,M){for(var K;;){if(C.lookahead===0&&(at(C),C.lookahead===0)){if(M===g)return e;break}if(C.match_length=0,K=r._tr_tally(C,0,C.window[C.strstart]),C.lookahead--,C.strstart++,K&&(z(C,!1),C.strm.avail_out===0))return e}return C.insert=0,M===w?(z(C,!0),C.strm.avail_out===0?Q:Z):C.last_lit&&(z(C,!1),C.strm.avail_out===0)?e:D})(c,N):c.strategy===3?(function(C,M){for(var K,G,Y,it,rt=C.window;;){if(C.lookahead<=H){if(at(C),C.lookahead<=H&&M===g)return e;if(C.lookahead===0)break}if(C.match_length=0,C.lookahead>=R&&0<C.strstart&&(G=rt[Y=C.strstart-1])===rt[++Y]&&G===rt[++Y]&&G===rt[++Y]){it=C.strstart+H;do;while(G===rt[++Y]&&G===rt[++Y]&&G===rt[++Y]&&G===rt[++Y]&&G===rt[++Y]&&G===rt[++Y]&&G===rt[++Y]&&G===rt[++Y]&&Y<it);C.match_length=H-(it-Y),C.match_length>C.lookahead&&(C.match_length=C.lookahead)}if(C.match_length>=R?(K=r._tr_tally(C,1,C.match_length-R),C.lookahead-=C.match_length,C.strstart+=C.match_length,C.match_length=0):(K=r._tr_tally(C,0,C.window[C.strstart]),C.lookahead--,C.strstart++),K&&(z(C,!1),C.strm.avail_out===0))return e}return C.insert=0,M===w?(z(C,!0),C.strm.avail_out===0?Q:Z):C.last_lit&&(z(C,!1),C.strm.avail_out===0)?e:D})(c,N):o[c.level].func(c,N);if(P!==Q&&P!==Z||(c.status=666),P===e||P===Q)return t.avail_out===0&&(c.last_flush=-1),i;if(P===D&&(N===1?r._tr_align(c):N!==5&&(r._tr_stored_block(c,0,0,!1),N===3&&(J(c.head),c.lookahead===0&&(c.strstart=0,c.block_start=0,c.insert=0))),I(t),t.avail_out===0))return c.last_flush=-1,i}return N!==w?i:c.wrap<=0?1:(c.wrap===2?($(c,255&t.adler),$(c,t.adler>>8&255),$(c,t.adler>>16&255),$(c,t.adler>>24&255),$(c,255&t.total_in),$(c,t.total_in>>8&255),$(c,t.total_in>>16&255),$(c,t.total_in>>24&255)):(q(c,t.adler>>>16),q(c,65535&t.adler)),I(t),0<c.wrap&&(c.wrap=-c.wrap),c.pending!==0?i:1)},m.deflateEnd=function(t){var N;return t&&t.state?(N=t.state.status)!==b&&N!==69&&N!==73&&N!==91&&N!==103&&N!==O&&N!==666?tt(t,d):(t.state=null,N===O?tt(t,-3):i):d},m.deflateSetDictionary=function(t,N){var T,c,l,k,U,P,C,M,K=N.length;if(!t||!t.state||(k=(T=t.state).wrap)===2||k===1&&T.status!==b||T.lookahead)return d;for(k===1&&(t.adler=a(t.adler,N,K,0)),T.wrap=0,K>=T.w_size&&(k===0&&(J(T.head),T.strstart=0,T.block_start=0,T.insert=0),M=new s.Buf8(T.w_size),s.arraySet(M,N,K-T.w_size,T.w_size,0),N=M,K=T.w_size),U=t.avail_in,P=t.next_in,C=t.input,t.avail_in=K,t.next_in=0,t.input=N,at(T);T.lookahead>=R;){for(c=T.strstart,l=T.lookahead-(R-1);T.ins_h=(T.ins_h<<T.hash_shift^T.window[c+R-1])&T.hash_mask,T.prev[c&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=c,c++,--l;);T.strstart=c,T.lookahead=R-1,at(T)}return T.strstart+=T.lookahead,T.block_start=T.strstart,T.insert=T.lookahead,T.lookahead=0,T.match_length=T.prev_length=R-1,T.match_available=0,t.next_in=P,t.input=C,t.avail_in=U,T.wrap=k,i},m.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(f,E,m){E.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(f,E,m){E.exports=function(o,s){var r,a,_,y,g,w,i,d,n,h,u,p,v,S,x,B,A,F,R,H,X,b,O,e,D;r=o.state,a=o.next_in,e=o.input,_=a+(o.avail_in-5),y=o.next_out,D=o.output,g=y-(s-o.avail_out),w=y+(o.avail_out-257),i=r.dmax,d=r.wsize,n=r.whave,h=r.wnext,u=r.window,p=r.hold,v=r.bits,S=r.lencode,x=r.distcode,B=(1<<r.lenbits)-1,A=(1<<r.distbits)-1;t:do{v<15&&(p+=e[a++]<<v,v+=8,p+=e[a++]<<v,v+=8),F=S[p&B];e:for(;;){if(p>>>=R=F>>>24,v-=R,(R=F>>>16&255)===0)D[y++]=65535&F;else{if(!(16&R)){if((64&R)==0){F=S[(65535&F)+(p&(1<<R)-1)];continue e}if(32&R){r.mode=12;break t}o.msg="invalid literal/length code",r.mode=30;break t}H=65535&F,(R&=15)&&(v<R&&(p+=e[a++]<<v,v+=8),H+=p&(1<<R)-1,p>>>=R,v-=R),v<15&&(p+=e[a++]<<v,v+=8,p+=e[a++]<<v,v+=8),F=x[p&A];r:for(;;){if(p>>>=R=F>>>24,v-=R,!(16&(R=F>>>16&255))){if((64&R)==0){F=x[(65535&F)+(p&(1<<R)-1)];continue r}o.msg="invalid distance code",r.mode=30;break t}if(X=65535&F,v<(R&=15)&&(p+=e[a++]<<v,(v+=8)<R&&(p+=e[a++]<<v,v+=8)),i<(X+=p&(1<<R)-1)){o.msg="invalid distance too far back",r.mode=30;break t}if(p>>>=R,v-=R,(R=y-g)<X){if(n<(R=X-R)&&r.sane){o.msg="invalid distance too far back",r.mode=30;break t}if(O=u,(b=0)===h){if(b+=d-R,R<H){for(H-=R;D[y++]=u[b++],--R;);b=y-X,O=D}}else if(h<R){if(b+=d+h-R,(R-=h)<H){for(H-=R;D[y++]=u[b++],--R;);if(b=0,h<H){for(H-=R=h;D[y++]=u[b++],--R;);b=y-X,O=D}}}else if(b+=h-R,R<H){for(H-=R;D[y++]=u[b++],--R;);b=y-X,O=D}for(;2<H;)D[y++]=O[b++],D[y++]=O[b++],D[y++]=O[b++],H-=3;H&&(D[y++]=O[b++],1<H&&(D[y++]=O[b++]))}else{for(b=y-X;D[y++]=D[b++],D[y++]=D[b++],D[y++]=D[b++],2<(H-=3););H&&(D[y++]=D[b++],1<H&&(D[y++]=D[b++]))}break}}break}}while(a<_&&y<w);a-=H=v>>3,p&=(1<<(v-=H<<3))-1,o.next_in=a,o.next_out=y,o.avail_in=a<_?_-a+5:5-(a-_),o.avail_out=y<w?w-y+257:257-(y-w),r.hold=p,r.bits=v}},{}],49:[function(f,E,m){var o=f("../utils/common"),s=f("./adler32"),r=f("./crc32"),a=f("./inffast"),_=f("./inftrees"),y=1,g=2,w=0,i=-2,d=1,n=852,h=592;function u(b){return(b>>>24&255)+(b>>>8&65280)+((65280&b)<<8)+((255&b)<<24)}function p(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function v(b){var O;return b&&b.state?(O=b.state,b.total_in=b.total_out=O.total=0,b.msg="",O.wrap&&(b.adler=1&O.wrap),O.mode=d,O.last=0,O.havedict=0,O.dmax=32768,O.head=null,O.hold=0,O.bits=0,O.lencode=O.lendyn=new o.Buf32(n),O.distcode=O.distdyn=new o.Buf32(h),O.sane=1,O.back=-1,w):i}function S(b){var O;return b&&b.state?((O=b.state).wsize=0,O.whave=0,O.wnext=0,v(b)):i}function x(b,O){var e,D;return b&&b.state?(D=b.state,O<0?(e=0,O=-O):(e=1+(O>>4),O<48&&(O&=15)),O&&(O<8||15<O)?i:(D.window!==null&&D.wbits!==O&&(D.window=null),D.wrap=e,D.wbits=O,S(b))):i}function B(b,O){var e,D;return b?(D=new p,(b.state=D).window=null,(e=x(b,O))!==w&&(b.state=null),e):i}var A,F,R=!0;function H(b){if(R){var O;for(A=new o.Buf32(512),F=new o.Buf32(32),O=0;O<144;)b.lens[O++]=8;for(;O<256;)b.lens[O++]=9;for(;O<280;)b.lens[O++]=7;for(;O<288;)b.lens[O++]=8;for(_(y,b.lens,0,288,A,0,b.work,{bits:9}),O=0;O<32;)b.lens[O++]=5;_(g,b.lens,0,32,F,0,b.work,{bits:5}),R=!1}b.lencode=A,b.lenbits=9,b.distcode=F,b.distbits=5}function X(b,O,e,D){var Q,Z=b.state;return Z.window===null&&(Z.wsize=1<<Z.wbits,Z.wnext=0,Z.whave=0,Z.window=new o.Buf8(Z.wsize)),D>=Z.wsize?(o.arraySet(Z.window,O,e-Z.wsize,Z.wsize,0),Z.wnext=0,Z.whave=Z.wsize):(D<(Q=Z.wsize-Z.wnext)&&(Q=D),o.arraySet(Z.window,O,e-D,Q,Z.wnext),(D-=Q)?(o.arraySet(Z.window,O,e-D,D,0),Z.wnext=D,Z.whave=Z.wsize):(Z.wnext+=Q,Z.wnext===Z.wsize&&(Z.wnext=0),Z.whave<Z.wsize&&(Z.whave+=Q))),0}m.inflateReset=S,m.inflateReset2=x,m.inflateResetKeep=v,m.inflateInit=function(b){return B(b,15)},m.inflateInit2=B,m.inflate=function(b,O){var e,D,Q,Z,tt,W,J,I,z,$,q,V,at,lt,et,nt,ut,st,dt,ft,t,N,T,c,l=0,k=new o.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!b||!b.state||!b.output||!b.input&&b.avail_in!==0)return i;(e=b.state).mode===12&&(e.mode=13),tt=b.next_out,Q=b.output,J=b.avail_out,Z=b.next_in,D=b.input,W=b.avail_in,I=e.hold,z=e.bits,$=W,q=J,N=w;t:for(;;)switch(e.mode){case d:if(e.wrap===0){e.mode=13;break}for(;z<16;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}if(2&e.wrap&&I===35615){k[e.check=0]=255&I,k[1]=I>>>8&255,e.check=r(e.check,k,2,0),z=I=0,e.mode=2;break}if(e.flags=0,e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&I)<<8)+(I>>8))%31){b.msg="incorrect header check",e.mode=30;break}if((15&I)!=8){b.msg="unknown compression method",e.mode=30;break}if(z-=4,t=8+(15&(I>>>=4)),e.wbits===0)e.wbits=t;else if(t>e.wbits){b.msg="invalid window size",e.mode=30;break}e.dmax=1<<t,b.adler=e.check=1,e.mode=512&I?10:12,z=I=0;break;case 2:for(;z<16;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}if(e.flags=I,(255&e.flags)!=8){b.msg="unknown compression method",e.mode=30;break}if(57344&e.flags){b.msg="unknown header flags set",e.mode=30;break}e.head&&(e.head.text=I>>8&1),512&e.flags&&(k[0]=255&I,k[1]=I>>>8&255,e.check=r(e.check,k,2,0)),z=I=0,e.mode=3;case 3:for(;z<32;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}e.head&&(e.head.time=I),512&e.flags&&(k[0]=255&I,k[1]=I>>>8&255,k[2]=I>>>16&255,k[3]=I>>>24&255,e.check=r(e.check,k,4,0)),z=I=0,e.mode=4;case 4:for(;z<16;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}e.head&&(e.head.xflags=255&I,e.head.os=I>>8),512&e.flags&&(k[0]=255&I,k[1]=I>>>8&255,e.check=r(e.check,k,2,0)),z=I=0,e.mode=5;case 5:if(1024&e.flags){for(;z<16;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}e.length=I,e.head&&(e.head.extra_len=I),512&e.flags&&(k[0]=255&I,k[1]=I>>>8&255,e.check=r(e.check,k,2,0)),z=I=0}else e.head&&(e.head.extra=null);e.mode=6;case 6:if(1024&e.flags&&(W<(V=e.length)&&(V=W),V&&(e.head&&(t=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Array(e.head.extra_len)),o.arraySet(e.head.extra,D,Z,V,t)),512&e.flags&&(e.check=r(e.check,D,V,Z)),W-=V,Z+=V,e.length-=V),e.length))break t;e.length=0,e.mode=7;case 7:if(2048&e.flags){if(W===0)break t;for(V=0;t=D[Z+V++],e.head&&t&&e.length<65536&&(e.head.name+=String.fromCharCode(t)),t&&V<W;);if(512&e.flags&&(e.check=r(e.check,D,V,Z)),W-=V,Z+=V,t)break t}else e.head&&(e.head.name=null);e.length=0,e.mode=8;case 8:if(4096&e.flags){if(W===0)break t;for(V=0;t=D[Z+V++],e.head&&t&&e.length<65536&&(e.head.comment+=String.fromCharCode(t)),t&&V<W;);if(512&e.flags&&(e.check=r(e.check,D,V,Z)),W-=V,Z+=V,t)break t}else e.head&&(e.head.comment=null);e.mode=9;case 9:if(512&e.flags){for(;z<16;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}if(I!==(65535&e.check)){b.msg="header crc mismatch",e.mode=30;break}z=I=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),b.adler=e.check=0,e.mode=12;break;case 10:for(;z<32;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}b.adler=e.check=u(I),z=I=0,e.mode=11;case 11:if(e.havedict===0)return b.next_out=tt,b.avail_out=J,b.next_in=Z,b.avail_in=W,e.hold=I,e.bits=z,2;b.adler=e.check=1,e.mode=12;case 12:if(O===5||O===6)break t;case 13:if(e.last){I>>>=7&z,z-=7&z,e.mode=27;break}for(;z<3;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}switch(e.last=1&I,z-=1,3&(I>>>=1)){case 0:e.mode=14;break;case 1:if(H(e),e.mode=20,O!==6)break;I>>>=2,z-=2;break t;case 2:e.mode=17;break;case 3:b.msg="invalid block type",e.mode=30}I>>>=2,z-=2;break;case 14:for(I>>>=7&z,z-=7&z;z<32;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}if((65535&I)!=(I>>>16^65535)){b.msg="invalid stored block lengths",e.mode=30;break}if(e.length=65535&I,z=I=0,e.mode=15,O===6)break t;case 15:e.mode=16;case 16:if(V=e.length){if(W<V&&(V=W),J<V&&(V=J),V===0)break t;o.arraySet(Q,D,Z,V,tt),W-=V,Z+=V,J-=V,tt+=V,e.length-=V;break}e.mode=12;break;case 17:for(;z<14;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}if(e.nlen=257+(31&I),I>>>=5,z-=5,e.ndist=1+(31&I),I>>>=5,z-=5,e.ncode=4+(15&I),I>>>=4,z-=4,286<e.nlen||30<e.ndist){b.msg="too many length or distance symbols",e.mode=30;break}e.have=0,e.mode=18;case 18:for(;e.have<e.ncode;){for(;z<3;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}e.lens[U[e.have++]]=7&I,I>>>=3,z-=3}for(;e.have<19;)e.lens[U[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,T={bits:e.lenbits},N=_(0,e.lens,0,19,e.lencode,0,e.work,T),e.lenbits=T.bits,N){b.msg="invalid code lengths set",e.mode=30;break}e.have=0,e.mode=19;case 19:for(;e.have<e.nlen+e.ndist;){for(;nt=(l=e.lencode[I&(1<<e.lenbits)-1])>>>16&255,ut=65535&l,!((et=l>>>24)<=z);){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}if(ut<16)I>>>=et,z-=et,e.lens[e.have++]=ut;else{if(ut===16){for(c=et+2;z<c;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}if(I>>>=et,z-=et,e.have===0){b.msg="invalid bit length repeat",e.mode=30;break}t=e.lens[e.have-1],V=3+(3&I),I>>>=2,z-=2}else if(ut===17){for(c=et+3;z<c;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}z-=et,t=0,V=3+(7&(I>>>=et)),I>>>=3,z-=3}else{for(c=et+7;z<c;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}z-=et,t=0,V=11+(127&(I>>>=et)),I>>>=7,z-=7}if(e.have+V>e.nlen+e.ndist){b.msg="invalid bit length repeat",e.mode=30;break}for(;V--;)e.lens[e.have++]=t}}if(e.mode===30)break;if(e.lens[256]===0){b.msg="invalid code -- missing end-of-block",e.mode=30;break}if(e.lenbits=9,T={bits:e.lenbits},N=_(y,e.lens,0,e.nlen,e.lencode,0,e.work,T),e.lenbits=T.bits,N){b.msg="invalid literal/lengths set",e.mode=30;break}if(e.distbits=6,e.distcode=e.distdyn,T={bits:e.distbits},N=_(g,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,T),e.distbits=T.bits,N){b.msg="invalid distances set",e.mode=30;break}if(e.mode=20,O===6)break t;case 20:e.mode=21;case 21:if(6<=W&&258<=J){b.next_out=tt,b.avail_out=J,b.next_in=Z,b.avail_in=W,e.hold=I,e.bits=z,a(b,q),tt=b.next_out,Q=b.output,J=b.avail_out,Z=b.next_in,D=b.input,W=b.avail_in,I=e.hold,z=e.bits,e.mode===12&&(e.back=-1);break}for(e.back=0;nt=(l=e.lencode[I&(1<<e.lenbits)-1])>>>16&255,ut=65535&l,!((et=l>>>24)<=z);){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}if(nt&&(240&nt)==0){for(st=et,dt=nt,ft=ut;nt=(l=e.lencode[ft+((I&(1<<st+dt)-1)>>st)])>>>16&255,ut=65535&l,!(st+(et=l>>>24)<=z);){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}I>>>=st,z-=st,e.back+=st}if(I>>>=et,z-=et,e.back+=et,e.length=ut,nt===0){e.mode=26;break}if(32&nt){e.back=-1,e.mode=12;break}if(64&nt){b.msg="invalid literal/length code",e.mode=30;break}e.extra=15&nt,e.mode=22;case 22:if(e.extra){for(c=e.extra;z<c;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}e.length+=I&(1<<e.extra)-1,I>>>=e.extra,z-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=23;case 23:for(;nt=(l=e.distcode[I&(1<<e.distbits)-1])>>>16&255,ut=65535&l,!((et=l>>>24)<=z);){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}if((240&nt)==0){for(st=et,dt=nt,ft=ut;nt=(l=e.distcode[ft+((I&(1<<st+dt)-1)>>st)])>>>16&255,ut=65535&l,!(st+(et=l>>>24)<=z);){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}I>>>=st,z-=st,e.back+=st}if(I>>>=et,z-=et,e.back+=et,64&nt){b.msg="invalid distance code",e.mode=30;break}e.offset=ut,e.extra=15&nt,e.mode=24;case 24:if(e.extra){for(c=e.extra;z<c;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}e.offset+=I&(1<<e.extra)-1,I>>>=e.extra,z-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){b.msg="invalid distance too far back",e.mode=30;break}e.mode=25;case 25:if(J===0)break t;if(V=q-J,e.offset>V){if((V=e.offset-V)>e.whave&&e.sane){b.msg="invalid distance too far back",e.mode=30;break}at=V>e.wnext?(V-=e.wnext,e.wsize-V):e.wnext-V,V>e.length&&(V=e.length),lt=e.window}else lt=Q,at=tt-e.offset,V=e.length;for(J<V&&(V=J),J-=V,e.length-=V;Q[tt++]=lt[at++],--V;);e.length===0&&(e.mode=21);break;case 26:if(J===0)break t;Q[tt++]=e.length,J--,e.mode=21;break;case 27:if(e.wrap){for(;z<32;){if(W===0)break t;W--,I|=D[Z++]<<z,z+=8}if(q-=J,b.total_out+=q,e.total+=q,q&&(b.adler=e.check=e.flags?r(e.check,Q,q,tt-q):s(e.check,Q,q,tt-q)),q=J,(e.flags?I:u(I))!==e.check){b.msg="incorrect data check",e.mode=30;break}z=I=0}e.mode=28;case 28:if(e.wrap&&e.flags){for(;z<32;){if(W===0)break t;W--,I+=D[Z++]<<z,z+=8}if(I!==(4294967295&e.total)){b.msg="incorrect length check",e.mode=30;break}z=I=0}e.mode=29;case 29:N=1;break t;case 30:N=-3;break t;case 31:return-4;case 32:default:return i}return b.next_out=tt,b.avail_out=J,b.next_in=Z,b.avail_in=W,e.hold=I,e.bits=z,(e.wsize||q!==b.avail_out&&e.mode<30&&(e.mode<27||O!==4))&&X(b,b.output,b.next_out,q-b.avail_out)?(e.mode=31,-4):($-=b.avail_in,q-=b.avail_out,b.total_in+=$,b.total_out+=q,e.total+=q,e.wrap&&q&&(b.adler=e.check=e.flags?r(e.check,Q,q,b.next_out-q):s(e.check,Q,q,b.next_out-q)),b.data_type=e.bits+(e.last?64:0)+(e.mode===12?128:0)+(e.mode===20||e.mode===15?256:0),($==0&&q===0||O===4)&&N===w&&(N=-5),N)},m.inflateEnd=function(b){if(!b||!b.state)return i;var O=b.state;return O.window&&(O.window=null),b.state=null,w},m.inflateGetHeader=function(b,O){var e;return b&&b.state?(2&(e=b.state).wrap)==0?i:((e.head=O).done=!1,w):i},m.inflateSetDictionary=function(b,O){var e,D=O.length;return b&&b.state?(e=b.state).wrap!==0&&e.mode!==11?i:e.mode===11&&s(1,O,D,0)!==e.check?-3:X(b,O,D,D)?(e.mode=31,-4):(e.havedict=1,w):i},m.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(f,E,m){var o=f("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],_=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];E.exports=function(y,g,w,i,d,n,h,u){var p,v,S,x,B,A,F,R,H,X=u.bits,b=0,O=0,e=0,D=0,Q=0,Z=0,tt=0,W=0,J=0,I=0,z=null,$=0,q=new o.Buf16(16),V=new o.Buf16(16),at=null,lt=0;for(b=0;b<=15;b++)q[b]=0;for(O=0;O<i;O++)q[g[w+O]]++;for(Q=X,D=15;1<=D&&q[D]===0;D--);if(D<Q&&(Q=D),D===0)return d[n++]=20971520,d[n++]=20971520,u.bits=1,0;for(e=1;e<D&&q[e]===0;e++);for(Q<e&&(Q=e),b=W=1;b<=15;b++)if(W<<=1,(W-=q[b])<0)return-1;if(0<W&&(y===0||D!==1))return-1;for(V[1]=0,b=1;b<15;b++)V[b+1]=V[b]+q[b];for(O=0;O<i;O++)g[w+O]!==0&&(h[V[g[w+O]]++]=O);if(A=y===0?(z=at=h,19):y===1?(z=s,$-=257,at=r,lt-=257,256):(z=a,at=_,-1),b=e,B=n,tt=O=I=0,S=-1,x=(J=1<<(Z=Q))-1,y===1&&852<J||y===2&&592<J)return 1;for(;;){for(F=b-tt,H=h[O]<A?(R=0,h[O]):h[O]>A?(R=at[lt+h[O]],z[$+h[O]]):(R=96,0),p=1<<b-tt,e=v=1<<Z;d[B+(I>>tt)+(v-=p)]=F<<24|R<<16|H|0,v!==0;);for(p=1<<b-1;I&p;)p>>=1;if(p!==0?(I&=p-1,I+=p):I=0,O++,--q[b]==0){if(b===D)break;b=g[w+h[O]]}if(Q<b&&(I&x)!==S){for(tt===0&&(tt=Q),B+=e,W=1<<(Z=b-tt);Z+tt<D&&!((W-=q[Z+tt])<=0);)Z++,W<<=1;if(J+=1<<Z,y===1&&852<J||y===2&&592<J)return 1;d[S=I&x]=Q<<24|Z<<16|B-n|0}}return I!==0&&(d[B+I]=b-tt<<24|64<<16|0),u.bits=Q,0}},{"../utils/common":41}],51:[function(f,E,m){E.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(f,E,m){var o=f("../utils/common"),s=0,r=1;function a(l){for(var k=l.length;0<=--k;)l[k]=0}var _=0,y=29,g=256,w=g+1+y,i=30,d=19,n=2*w+1,h=15,u=16,p=7,v=256,S=16,x=17,B=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],F=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=new Array(2*(w+2));a(X);var b=new Array(2*i);a(b);var O=new Array(512);a(O);var e=new Array(256);a(e);var D=new Array(y);a(D);var Q,Z,tt,W=new Array(i);function J(l,k,U,P,C){this.static_tree=l,this.extra_bits=k,this.extra_base=U,this.elems=P,this.max_length=C,this.has_stree=l&&l.length}function I(l,k){this.dyn_tree=l,this.max_code=0,this.stat_desc=k}function z(l){return l<256?O[l]:O[256+(l>>>7)]}function $(l,k){l.pending_buf[l.pending++]=255&k,l.pending_buf[l.pending++]=k>>>8&255}function q(l,k,U){l.bi_valid>u-U?(l.bi_buf|=k<<l.bi_valid&65535,$(l,l.bi_buf),l.bi_buf=k>>u-l.bi_valid,l.bi_valid+=U-u):(l.bi_buf|=k<<l.bi_valid&65535,l.bi_valid+=U)}function V(l,k,U){q(l,U[2*k],U[2*k+1])}function at(l,k){for(var U=0;U|=1&l,l>>>=1,U<<=1,0<--k;);return U>>>1}function lt(l,k,U){var P,C,M=new Array(h+1),K=0;for(P=1;P<=h;P++)M[P]=K=K+U[P-1]<<1;for(C=0;C<=k;C++){var G=l[2*C+1];G!==0&&(l[2*C]=at(M[G]++,G))}}function et(l){var k;for(k=0;k<w;k++)l.dyn_ltree[2*k]=0;for(k=0;k<i;k++)l.dyn_dtree[2*k]=0;for(k=0;k<d;k++)l.bl_tree[2*k]=0;l.dyn_ltree[2*v]=1,l.opt_len=l.static_len=0,l.last_lit=l.matches=0}function nt(l){8<l.bi_valid?$(l,l.bi_buf):0<l.bi_valid&&(l.pending_buf[l.pending++]=l.bi_buf),l.bi_buf=0,l.bi_valid=0}function ut(l,k,U,P){var C=2*k,M=2*U;return l[C]<l[M]||l[C]===l[M]&&P[k]<=P[U]}function st(l,k,U){for(var P=l.heap[U],C=U<<1;C<=l.heap_len&&(C<l.heap_len&&ut(k,l.heap[C+1],l.heap[C],l.depth)&&C++,!ut(k,P,l.heap[C],l.depth));)l.heap[U]=l.heap[C],U=C,C<<=1;l.heap[U]=P}function dt(l,k,U){var P,C,M,K,G=0;if(l.last_lit!==0)for(;P=l.pending_buf[l.d_buf+2*G]<<8|l.pending_buf[l.d_buf+2*G+1],C=l.pending_buf[l.l_buf+G],G++,P===0?V(l,C,k):(V(l,(M=e[C])+g+1,k),(K=A[M])!==0&&q(l,C-=D[M],K),V(l,M=z(--P),U),(K=F[M])!==0&&q(l,P-=W[M],K)),G<l.last_lit;);V(l,v,k)}function ft(l,k){var U,P,C,M=k.dyn_tree,K=k.stat_desc.static_tree,G=k.stat_desc.has_stree,Y=k.stat_desc.elems,it=-1;for(l.heap_len=0,l.heap_max=n,U=0;U<Y;U++)M[2*U]!==0?(l.heap[++l.heap_len]=it=U,l.depth[U]=0):M[2*U+1]=0;for(;l.heap_len<2;)M[2*(C=l.heap[++l.heap_len]=it<2?++it:0)]=1,l.depth[C]=0,l.opt_len--,G&&(l.static_len-=K[2*C+1]);for(k.max_code=it,U=l.heap_len>>1;1<=U;U--)st(l,M,U);for(C=Y;U=l.heap[1],l.heap[1]=l.heap[l.heap_len--],st(l,M,1),P=l.heap[1],l.heap[--l.heap_max]=U,l.heap[--l.heap_max]=P,M[2*C]=M[2*U]+M[2*P],l.depth[C]=(l.depth[U]>=l.depth[P]?l.depth[U]:l.depth[P])+1,M[2*U+1]=M[2*P+1]=C,l.heap[1]=C++,st(l,M,1),2<=l.heap_len;);l.heap[--l.heap_max]=l.heap[1],(function(rt,ht){var wt,pt,yt,ot,Et,Tt,mt=ht.dyn_tree,jt=ht.max_code,se=ht.stat_desc.static_tree,oe=ht.stat_desc.has_stree,ue=ht.stat_desc.extra_bits,Zt=ht.stat_desc.extra_base,vt=ht.stat_desc.max_length,Ct=0;for(ot=0;ot<=h;ot++)rt.bl_count[ot]=0;for(mt[2*rt.heap[rt.heap_max]+1]=0,wt=rt.heap_max+1;wt<n;wt++)vt<(ot=mt[2*mt[2*(pt=rt.heap[wt])+1]+1]+1)&&(ot=vt,Ct++),mt[2*pt+1]=ot,jt<pt||(rt.bl_count[ot]++,Et=0,Zt<=pt&&(Et=ue[pt-Zt]),Tt=mt[2*pt],rt.opt_len+=Tt*(ot+Et),oe&&(rt.static_len+=Tt*(se[2*pt+1]+Et)));if(Ct!==0){do{for(ot=vt-1;rt.bl_count[ot]===0;)ot--;rt.bl_count[ot]--,rt.bl_count[ot+1]+=2,rt.bl_count[vt]--,Ct-=2}while(0<Ct);for(ot=vt;ot!==0;ot--)for(pt=rt.bl_count[ot];pt!==0;)jt<(yt=rt.heap[--wt])||(mt[2*yt+1]!==ot&&(rt.opt_len+=(ot-mt[2*yt+1])*mt[2*yt],mt[2*yt+1]=ot),pt--)}})(l,k),lt(M,it,l.bl_count)}function t(l,k,U){var P,C,M=-1,K=k[1],G=0,Y=7,it=4;for(K===0&&(Y=138,it=3),k[2*(U+1)+1]=65535,P=0;P<=U;P++)C=K,K=k[2*(P+1)+1],++G<Y&&C===K||(G<it?l.bl_tree[2*C]+=G:C!==0?(C!==M&&l.bl_tree[2*C]++,l.bl_tree[2*S]++):G<=10?l.bl_tree[2*x]++:l.bl_tree[2*B]++,M=C,it=(G=0)===K?(Y=138,3):C===K?(Y=6,3):(Y=7,4))}function N(l,k,U){var P,C,M=-1,K=k[1],G=0,Y=7,it=4;for(K===0&&(Y=138,it=3),P=0;P<=U;P++)if(C=K,K=k[2*(P+1)+1],!(++G<Y&&C===K)){if(G<it)for(;V(l,C,l.bl_tree),--G!=0;);else C!==0?(C!==M&&(V(l,C,l.bl_tree),G--),V(l,S,l.bl_tree),q(l,G-3,2)):G<=10?(V(l,x,l.bl_tree),q(l,G-3,3)):(V(l,B,l.bl_tree),q(l,G-11,7));M=C,it=(G=0)===K?(Y=138,3):C===K?(Y=6,3):(Y=7,4)}}a(W);var T=!1;function c(l,k,U,P){q(l,(_<<1)+(P?1:0),3),(function(C,M,K,G){nt(C),$(C,K),$(C,~K),o.arraySet(C.pending_buf,C.window,M,K,C.pending),C.pending+=K})(l,k,U)}m._tr_init=function(l){T||((function(){var k,U,P,C,M,K=new Array(h+1);for(C=P=0;C<y-1;C++)for(D[C]=P,k=0;k<1<<A[C];k++)e[P++]=C;for(e[P-1]=C,C=M=0;C<16;C++)for(W[C]=M,k=0;k<1<<F[C];k++)O[M++]=C;for(M>>=7;C<i;C++)for(W[C]=M<<7,k=0;k<1<<F[C]-7;k++)O[256+M++]=C;for(U=0;U<=h;U++)K[U]=0;for(k=0;k<=143;)X[2*k+1]=8,k++,K[8]++;for(;k<=255;)X[2*k+1]=9,k++,K[9]++;for(;k<=279;)X[2*k+1]=7,k++,K[7]++;for(;k<=287;)X[2*k+1]=8,k++,K[8]++;for(lt(X,w+1,K),k=0;k<i;k++)b[2*k+1]=5,b[2*k]=at(k,5);Q=new J(X,A,g+1,w,h),Z=new J(b,F,0,i,h),tt=new J(new Array(0),R,0,d,p)})(),T=!0),l.l_desc=new I(l.dyn_ltree,Q),l.d_desc=new I(l.dyn_dtree,Z),l.bl_desc=new I(l.bl_tree,tt),l.bi_buf=0,l.bi_valid=0,et(l)},m._tr_stored_block=c,m._tr_flush_block=function(l,k,U,P){var C,M,K=0;0<l.level?(l.strm.data_type===2&&(l.strm.data_type=(function(G){var Y,it=4093624447;for(Y=0;Y<=31;Y++,it>>>=1)if(1&it&&G.dyn_ltree[2*Y]!==0)return s;if(G.dyn_ltree[18]!==0||G.dyn_ltree[20]!==0||G.dyn_ltree[26]!==0)return r;for(Y=32;Y<g;Y++)if(G.dyn_ltree[2*Y]!==0)return r;return s})(l)),ft(l,l.l_desc),ft(l,l.d_desc),K=(function(G){var Y;for(t(G,G.dyn_ltree,G.l_desc.max_code),t(G,G.dyn_dtree,G.d_desc.max_code),ft(G,G.bl_desc),Y=d-1;3<=Y&&G.bl_tree[2*H[Y]+1]===0;Y--);return G.opt_len+=3*(Y+1)+5+5+4,Y})(l),C=l.opt_len+3+7>>>3,(M=l.static_len+3+7>>>3)<=C&&(C=M)):C=M=U+5,U+4<=C&&k!==-1?c(l,k,U,P):l.strategy===4||M===C?(q(l,2+(P?1:0),3),dt(l,X,b)):(q(l,4+(P?1:0),3),(function(G,Y,it,rt){var ht;for(q(G,Y-257,5),q(G,it-1,5),q(G,rt-4,4),ht=0;ht<rt;ht++)q(G,G.bl_tree[2*H[ht]+1],3);N(G,G.dyn_ltree,Y-1),N(G,G.dyn_dtree,it-1)})(l,l.l_desc.max_code+1,l.d_desc.max_code+1,K+1),dt(l,l.dyn_ltree,l.dyn_dtree)),et(l),P&&nt(l)},m._tr_tally=function(l,k,U){return l.pending_buf[l.d_buf+2*l.last_lit]=k>>>8&255,l.pending_buf[l.d_buf+2*l.last_lit+1]=255&k,l.pending_buf[l.l_buf+l.last_lit]=255&U,l.last_lit++,k===0?l.dyn_ltree[2*U]++:(l.matches++,k--,l.dyn_ltree[2*(e[U]+g+1)]++,l.dyn_dtree[2*z(k)]++),l.last_lit===l.lit_bufsize-1},m._tr_align=function(l){q(l,2,3),V(l,v,X),(function(k){k.bi_valid===16?($(k,k.bi_buf),k.bi_buf=0,k.bi_valid=0):8<=k.bi_valid&&(k.pending_buf[k.pending++]=255&k.bi_buf,k.bi_buf>>=8,k.bi_valid-=8)})(l)}},{"../utils/common":41}],53:[function(f,E,m){E.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(f,E,m){(function(o){(function(s,r){if(!s.setImmediate){var a,_,y,g,w=1,i={},d=!1,n=s.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(s);h=h&&h.setTimeout?h:s,a={}.toString.call(s.process)==="[object process]"?function(S){process.nextTick(function(){p(S)})}:(function(){if(s.postMessage&&!s.importScripts){var S=!0,x=s.onmessage;return s.onmessage=function(){S=!1},s.postMessage("","*"),s.onmessage=x,S}})()?(g="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",v,!1):s.attachEvent("onmessage",v),function(S){s.postMessage(g+S,"*")}):s.MessageChannel?((y=new MessageChannel).port1.onmessage=function(S){p(S.data)},function(S){y.port2.postMessage(S)}):n&&"onreadystatechange"in n.createElement("script")?(_=n.documentElement,function(S){var x=n.createElement("script");x.onreadystatechange=function(){p(S),x.onreadystatechange=null,_.removeChild(x),x=null},_.appendChild(x)}):function(S){setTimeout(p,0,S)},h.setImmediate=function(S){typeof S!="function"&&(S=new Function(""+S));for(var x=new Array(arguments.length-1),B=0;B<x.length;B++)x[B]=arguments[B+1];var A={callback:S,args:x};return i[w]=A,a(w),w++},h.clearImmediate=u}function u(S){delete i[S]}function p(S){if(d)setTimeout(p,0,S);else{var x=i[S];if(x){d=!0;try{(function(B){var A=B.callback,F=B.args;switch(F.length){case 0:A();break;case 1:A(F[0]);break;case 2:A(F[0],F[1]);break;case 3:A(F[0],F[1],F[2]);break;default:A.apply(r,F)}})(x)}finally{u(S),d=!1}}}}function v(S){S.source===s&&typeof S.data=="string"&&S.data.indexOf(g)===0&&p(+S.data.slice(g.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof window<"u"?window:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(zt)),zt.exports}var qt=Vt();const Kt=gt(qt),Xt=L=>L&&L.getContent&&typeof L.getContent=="function";async function Ft(L,j,f,E){var i,d,n,h,u;let m;Xt(L)?m=L:m=await L.runRenderer({galleyMode:!1,interactivityActions:[],...j&&j.renderOptions});const o={csvSettings:{colSeparator:((i=j==null?void 0:j.csvSettings)==null?void 0:i.colSeparator)??",",rowSeparator:((d=j==null?void 0:j.csvSettings)==null?void 0:d.rowSeparator)??`
`,tableSeparator:((n=j==null?void 0:j.csvSettings)==null?void 0:n.tableSeparator)??"===============",quotationSymbol:((h=j==null?void 0:j.csvSettings)==null?void 0:h.quotationSymbol)??'"',outputType:((u=j==null?void 0:j.csvSettings)==null?void 0:u.outputType)??"plain"},format:(j==null?void 0:j.format)??"csv"},s=m.i18n,r=s.t("exportxlsx:messages.cancel-message","Export process was cancelled by user"),a=m.render();for(;!a.next().done;)if(E&&E())return new Promise((p,v)=>{v(r)});const{pages:_,patches:y}=m.getContent();let g=0;const w=()=>{if(g>=_.length)return null;const p=_[g],v=Bt(y[g]??[]);return g++,{node:p,patches:v}};return new Promise(async(p,v)=>{try{if(E){const F=()=>{E()?v(r):setTimeout(F,2e3)};F()}let S=w();if(!S){v(s.t("exportxlsx:messages.first-page-render-failed","First page render failed"));return}const x=[];let B=1;for(;S;){if(E&&E()){v(r);return}const F=_t(S.node,"sliceIndex",0);x[F]=x[F]??[],x[F].push(S),f&&f(B),B++,S=w()}const A=[].concat(...x);if(o.format==="csv"){const F=await Yt(A,o.csvSettings);p(F)}else v(s.t("exporttabulardata:messages.format-not-supported","Format is not supported"))}catch(S){v(S)}})}const _t=(L,j,f)=>{var E;return((E=L.properties.meta)==null?void 0:E[j])??f};async function Yt(L,j){if(j.outputType==="plain"){const f=Ut(L,j).map(E=>E.content).join(`${j.rowSeparator}${j.tableSeparator}${j.rowSeparator}`);return{data:f,download:E=>Nt(f,E)}}else{const f=new Kt,E=Ut(L,j);for(const o of E)f.file(o.name+".csv","\uFEFF"+o.content);const m=await f.generateAsync({type:"blob"});return{data:m,download:o=>Nt(m,o)}}}function Ut(L,j){const f=$t(L);return Object.keys(f).map(m=>({name:m,content:ne(f[m],j)}))}function $t(L){const j={},f=(E,m)=>{var o;if(E.tagName==="TABLE"){const s=(o=E.properties.attributes)==null?void 0:o["data-name"];s&&(j[s]=j[s]||[],j[s].push(Jt(E,m)))}else E.children.filter(s=>s.type==="VirtualNode").forEach(s=>f(s,m))};return L.forEach(E=>f(E.node,E.patches)),j}function Jt(L,j){if(L.tagName!=="TABLE")throw new Error(`Expected <TABLE>, but was <${L.tagName}>`);const f=It(It(L,"TBODY")[0],"TR"),E=[];for(const m of f){const o=It(m,"TD"),s=[];for(const r of o){const a=Pt(r,j),_=_t(r,"colNumber",-1),y=_t(r,"rowNumber",-1),g=_t(r,"scopeID",-1),w=_t(r,"rowType","unknown"),i=_t(r,"cellType","unknown"),d=r.properties.colSpan,n=r.properties.rowSpan;s.push({value:a,colNumber:_-d,rowSpan:n,rowNumber:y,scopeID:g,rowType:w,cellType:i});for(let h=1;h<d;h++)s.push({value:"",colNumber:_-d+h,rowSpan:n,rowNumber:y,scopeID:g,rowType:w,cellType:i})}E.push(s)}for(let m=0;m<E.length;m++)for(let o=0;o<E[m].length;o++)E[m][o].rowSpan>1&&E[m+1].splice(o,0,{...E[m][o],value:"",rowSpan:E[m][o].rowSpan-1});return E}function Qt(L,j){if(L.length!==j.length)throw new Error("Cannot join blocks of different lengths");const f=[...L];return j.forEach((E,m)=>f[m].push(...E)),f}function te(L){let j=Number.MIN_SAFE_INTEGER,f=Number.MIN_SAFE_INTEGER,E=Number.MIN_SAFE_INTEGER,m=Number.MAX_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER;return L.forEach(r=>r.forEach(a=>{a.rowType==="details"&&(a.rowNumber>j&&(j=a.rowNumber),a.colNumber>f&&(f=a.colNumber),a.scopeID>E&&(E=a.scopeID),a.rowNumber<m&&(m=a.rowNumber),a.colNumber<o&&(o=a.colNumber),a.scopeID<s&&(s=a.scopeID))})),{maxRowNumber:j,maxColNumber:f,maxScopeID:E,minRowNumber:m,minColNumber:o,minScopeID:s}}const ee=L=>L.map(j=>j.filter(f=>f.every(E=>E.rowType!=="filler"))).map(j=>({block:j,rect:te(j)})).sort((j,f)=>j.rect.maxRowNumber>f.rect.minRowNumber?1:j.rect.minRowNumber<f.rect.maxRowNumber?-1:j.rect.maxColNumber>f.rect.minColNumber?1:j.rect.minColNumber<f.rect.maxColNumber?-1:j.block.every(E=>E.every(m=>m.rowType==="footer"||m.rowType==="header"))?1:f.block.every(E=>E.every(m=>m.rowType==="footer"||m.rowType==="header"))?-1:0).map(j=>j.block),re=(L,j)=>{if(j.colNumber>=L.colNumber){if(j.colNumber===L.colNumber&&(L.cellType==="body"||j.cellType==="body"||L.cellType==="unknown"||j.cellType==="unknown"))return!1;if(L.cellType===j.cellType)return!0;if(L.cellType==="corner")return j.cellType==="column";if(L.cellType==="row")return j.cellType==="body"}return!1};function ne(L,j){if(L.length===0)return"";const f=ee(L),E=[f[0]];for(let r=1;r<f.length;r++){const a=bt(bt(f[r])),_=bt(bt(bt(E)));re(_,a)?E[E.length-1]=Qt(E[E.length-1],f[r]):E.push(f[r])}if(E.some(r=>r.some(a=>a.length!==E[0][0].length)))throw new Error("Data blocks join failed");const m=[],o=[];for(const r of Bt(E))if(r.every(a=>a.rowType!=="details"&&a.rowType!=="footer")){const a=At(r);o.includes(a)||(m.push(r),o.push(a))}else m.push(r);const s=[];for(let r=m.length-1;r>=0;r--)if(m[r].every(a=>a.rowType==="footer")){const a=At(m[r]);s.includes(a)?m.splice(r,1):s.push(a)}if(m.length>0){const r=[];for(let a=0;a<m[0].length;a++){const _=[];for(let y=0;y<m.length;y++)_.push(m[y][a]);if(_.every(y=>y.rowType!=="details")){const y=At(_);if(r.includes(y)){for(let g=0;g<m.length;g++)m[g].splice(a,1);a--}else r.push(y)}}}return m.map(r=>r.map(a=>ae(a.value,j)).join(j.colSeparator)).join(j.rowSeparator)}const ie=L=>`${L.colNumber}/${L.rowNumber}/${L.rowSpan}/${L.scopeID}/${L.rowType}/${JSON.stringify(L.value)}`,At=L=>L.map(ie).join("|"),It=(L,j)=>L.children.filter(f=>f.type==="VirtualNode"&&f.tagName===j),Pt=(L,j)=>{var m;if(["TABLE","SVG"].includes(L.tagName))return;const f=_t(L,"rawValue",void 0);if(f!==void 0)return f;const E=(((m=bt(j.filter(o=>o.id===L.properties.id)))==null?void 0:m.children)??L.children).filter(o=>o.type==="VirtualNode");for(const o of E){const s=Pt(o,j);if(s!==void 0)return s}},ae=(L,j)=>{switch(typeof L){case"number":return Lt(L.toString(),j);case"string":return Lt(L,j);case"boolean":return L?"True":"False";case"object":return typeof(L==null?void 0:L.toISOString)=="function"?L.toISOString():"";default:return""}},Lt=(L,j)=>{const f=L.includes(j.rowSeparator)||L.includes(j.colSeparator)||L.includes(j.quotationSymbol),E=f?L.replace(new RegExp(j.quotationSymbol,"g"),`${j.quotationSymbol}${j.quotationSymbol}`):L;return f?`${j.quotationSymbol}${E}${j.quotationSymbol}`:E};Gt(),ct.exportDocument=Ft,Object.defineProperty(ct,Symbol.toStringTag,{value:"Module"})}));
